bG9jYWwgQ29uZmlnc19IVUIgPSB7CiAgQ29yX0h1YiA9IENvbG9yMy5mcm9tUkdCKDI1LCAyNSwgMjUpLAogIENvcl9PcHRpb25zID0gQ29sb3IzLmZyb21SR0IoMCwwLDAgLyAyNTUsMTUzLDApLAogIENvcl9TdHJva2UgPSBDb2xvcjMuZnJvbVJHQig2MCwgNjAsIDYwKSwKICBDb3JfVGV4dCA9IENvbG9yMy5mcm9tUkdCKDI0MCwgMjQwLCAyNDApLAogIENvcl9EYXJrVGV4dCA9IENvbG9yMy5mcm9tUkdCKDE0MCwgMTQwLCAxNDApLAogIENvcm5lcl9SYWRpdXMgPSBVRGltLm5ldygwLCAxMiksCiAgVGV4dF9Gb250ID0gRW51bS5Gb250LkZyZWRva2FPbmUKfQoKbG9jYWwgQ29yZUd1aSA9IGdhbWU6R2V0U2VydmljZSgiQ29yZUd1aSIpCmxvY2FsIFR3ZWVuU2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVHdlZW5TZXJ2aWNlIikKbG9jYWwgVXNlcklucHV0U2VydmljZSA9IGdhbWU6R2V0U2VydmljZSgiVXNlcklucHV0U2VydmljZSIpCgpsb2NhbCBmdW5jdGlvbiBDcmVhdGUoaW5zdGFuY2UsIHBhcmVudCwgcHJvcHMpCiAgbG9jYWwgbmV3ID0gSW5zdGFuY2UubmV3KGluc3RhbmNlLCBwYXJlbnQpCiAgaWYgcHJvcHMgdGhlbgogICAgdGFibGUuZm9yZWFjaChwcm9wcywgZnVuY3Rpb24ocHJvcCwgdmFsdWUpCiAgICAgIG5ld1twcm9wXSA9IHZhbHVlCiAgICBlbmQpCiAgZW5kCiAgcmV0dXJuIG5ldwplbmQKCmxvY2FsIGZ1bmN0aW9uIFNldFByb3BzKGluc3RhbmNlLCBwcm9wcykKICBpZiBpbnN0YW5jZSBhbmQgcHJvcHMgdGhlbgogICAgdGFibGUuZm9yZWFjaChwcm9wcywgZnVuY3Rpb24ocHJvcCwgdmFsdWUpCiAgICAgIGluc3RhbmNlW3Byb3BdID0gdmFsdWUKICAgIGVuZCkKICBlbmQKICByZXR1cm4gaW5zdGFuY2UKZW5kCgpsb2NhbCBmdW5jdGlvbiBDb3JuZXIocGFyZW50LCBwcm9wcykKICBsb2NhbCBuZXcgPSBDcmVhdGUoIlVJQ29ybmVyIiwgcGFyZW50KQogIG5ldy5Db3JuZXJSYWRpdXMgPSBDb25maWdzX0hVQi5Db3JuZXJfUmFkaXVzCiAgaWYgcHJvcHMgdGhlbgogICAgU2V0UHJvcHMobmV3LCBwcm9wcykKICBlbmQKICByZXR1cm4gbmV3CmVuZAoKbG9jYWwgZnVuY3Rpb24gU3Ryb2tlKHBhcmVudCwgcHJvcHMpCiAgbG9jYWwgbmV3ID0gQ3JlYXRlKCJVSVN0cm9rZSIsIHBhcmVudCkKICBuZXcuQ29sb3IgPSBDb25maWdzX0hVQi5Db3JfU3Ryb2tlCiAgbmV3LkFwcGx5U3Ryb2tlTW9kZSA9ICJCb3JkZXIiCiAgaWYgcHJvcHMgdGhlbgogICAgU2V0UHJvcHMobmV3LCBwcm9wcykKICBlbmQKICByZXR1cm4gbmV3CmVuZAoKbG9jYWwgZnVuY3Rpb24gQ3JlYXRlVHdlZW4oaW5zdGFuY2UsIHByb3AsIHZhbHVlLCB0aW1lLCB0d2VlbldhaXQpCiAgbG9jYWwgdHdlZW4gPSBUd2VlblNlcnZpY2U6Q3JlYXRlKGluc3RhbmNlLAogIFR3ZWVuSW5mby5uZXcodGltZSwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIpLAogIHtbcHJvcF0gPSB2YWx1ZX0pCiAgdHdlZW46UGxheSgpCiAgaWYgdHdlZW5XYWl0IHRoZW4KICAgIHR3ZWVuLkNvbXBsZXRlZDpXYWl0KCkKICBlbmQKZW5kCgpsb2NhbCBmdW5jdGlvbiBUZXh0U2V0Q29sb3IoaW5zdGFuY2UpCiAgaW5zdGFuY2UuTW91c2VFbnRlcjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIENyZWF0ZVR3ZWVuKGluc3RhbmNlLCAiVGV4dENvbG9yMyIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuNCwgdHJ1ZSkKICBlbmQpCiAgaW5zdGFuY2UuTW91c2VMZWF2ZTpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIENyZWF0ZVR3ZWVuKGluc3RhbmNlLCAiVGV4dENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9UZXh0LCAwLjQsIGZhbHNlKQogIGVuZCkKZW5kCgpsb2NhbCBTY3JlZW5HdWkgPSBDcmVhdGUoIlNjcmVlbkd1aSIsIENvcmVHdWksIHsKICBOYW1lID0gIlJFRHogSFVCIGxpYnJhcnkiCn0pCgpTY3JlZW5GaW5kID0gQ29yZUd1aTpGaW5kRmlyc3RDaGlsZChTY3JlZW5HdWkuTmFtZSkKaWYgU2NyZWVuRmluZCBhbmQgU2NyZWVuRmluZCB+PSBTY3JlZW5HdWkgdGhlbgogIFNjcmVlbkZpbmQ6RGVzdHJveSgpCmVuZAoKZnVuY3Rpb24gRGVzdHJveVNjcmlwdCgpCiAgU2NyZWVuR3VpOkRlc3Ryb3koKQplbmQKCmxvY2FsIE1lbnVfTm90aWZpID0gQ3JlYXRlKCJGcmFtZSIsIFNjcmVlbkd1aSwgewogIFNpemUgPSBVRGltMi5uZXcoMCwgMzAwLCAxLCAwKSwKICBQb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAwLCAwLCAwKSwKICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDEsIDApLAogIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCn0pCgpsb2NhbCBQYWRkaW5nID0gQ3JlYXRlKCJVSVBhZGRpbmciLCBNZW51X05vdGlmaSwgewogIFBhZGRpbmdMZWZ0ID0gVURpbS5uZXcoMCwgMjUpLAogIFBhZGRpbmdUb3AgPSBVRGltLm5ldygwLCAyNSksCiAgUGFkZGluZ0JvdHRvbSA9IFVEaW0ubmV3KDAsIDUwKQp9KQoKbG9jYWwgTGlzdExheW91dCA9IENyZWF0ZSgiVUlMaXN0TGF5b3V0IiwgTWVudV9Ob3RpZmksIHsKICBQYWRkaW5nID0gVURpbS5uZXcoMCwgMTUpLAogIFZlcnRpY2FsQWxpZ25tZW50ID0gIkJvdHRvbSIKfSkKCmZ1bmN0aW9uIE1ha2VOb3RpZmkoQ29uZmlncykKICBsb2NhbCBUaXRsZSA9IENvbmZpZ3MuVGl0bGUgb3IgIlJFRHogSFVCIgogIGxvY2FsIHRleHQgPSBDb25maWdzLlRleHQgb3IgIk5vdGlmaWNhw6fDo28iCiAgbG9jYWwgdGltZXdhaXQgPSBDb25maWdzLlRpbWUgb3IgNQogIAogIGxvY2FsIEZyYW1lMSA9IENyZWF0ZSgiRnJhbWUiLCBNZW51X05vdGlmaSwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygyLCAwLCAwLCAwKSwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgQXV0b21hdGljU2l6ZSA9ICJZIiwKICAgIE5hbWUgPSAiVGl0bGUiCiAgfSkKICAKICBsb2NhbCBGcmFtZTIgPSBDcmVhdGUoIkZyYW1lIiwgRnJhbWUxLCB7CiAgICBTaXplID0gVURpbTIubmV3KDAsIE1lbnVfTm90aWZpLlNpemUuWC5PZmZzZXQgLSA1MCwgMCwgMCksCiAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YiwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIE1lbnVfTm90aWZpLlNpemUuWC5PZmZzZXQsIDAsIDApLAogICAgQXV0b21hdGljU2l6ZSA9ICJZIgogIH0pQ29ybmVyKEZyYW1lMikKICAKICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEZyYW1lMiwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICBUZXh0ID0gVGl0bGUsCiAgICBUZXh0U2l6ZSA9IDIwLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjAsIDAsIDUpLAogICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQKICB9KQogIAogIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBGcmFtZTIsIHsKICAgIFRleHQgPSAiWCIsCiAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgVGV4dFNpemUgPSAyMCwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIwMCwgMjAwLCAyMDApLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgLTUsIDAsIDUpLAogICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygxLCAwKSwKICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMjUsIDAsIDI1KQogIH0pCiAgCiAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZTIsIHsKICAgIFNpemUgPSBVRGltMi5uZXcoMSwgLTMwLCAwLCAwKSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDIwLCAwLCBUZXh0QnV0dG9uLlNpemUuWS5PZmZzZXQgKyAxMCksCiAgICBUZXh0U2l6ZSA9IDE1LAogICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9EYXJrVGV4dCwKICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgVGV4dFlBbGlnbm1lbnQgPSAiVG9wIiwKICAgIEF1dG9tYXRpY1NpemUgPSAiWSIsCiAgICBUZXh0ID0gdGV4dCwKICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIEF1dG9tYXRpY1NpemUgPSBFbnVtLkF1dG9tYXRpY1NpemUuWSwKICAgIFRleHRXcmFwcGVkID0gdHJ1ZQogIH0pCiAgCiAgbG9jYWwgRnJhbWVTaXplID0gQ3JlYXRlKCJGcmFtZSIsIEZyYW1lMiwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyKSwKICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfU3Ryb2tlLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMiwgMCwgMzApLAogICAgQm9yZGVyU2l6ZVBpeGVsID0gMAogIH0pQ29ybmVyKEZyYW1lU2l6ZSlDcmVhdGUoIkZyYW1lIiwgRnJhbWUyLCB7CiAgICBTaXplID0gVURpbTIubmV3KDAsIDAsIDAsIDUpLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMSwgNSksCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogIH0pCiAgCiAgdGFzay5zcGF3bihmdW5jdGlvbigpCiAgICBDcmVhdGVUd2VlbihGcmFtZVNpemUsICJTaXplIiwgVURpbTIubmV3KDAsIDAsIDAsIDIpLCB0aW1ld2FpdCwgdHJ1ZSkKICBlbmQpCiAgCiAgVGV4dEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIC0yMCwgMCwgMCksIDAuMSwgdHJ1ZSkKICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIE1lbnVfTm90aWZpLlNpemUuWC5PZmZzZXQsIDAsIDApLCAwLjUsIHRydWUpCiAgICBGcmFtZTE6RGVzdHJveSgpCiAgZW5kKQogIAogIHRhc2suc3Bhd24oZnVuY3Rpb24oKQogICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgLTIwLCAwLCAwKSwgMC41LCB0cnVlKQogICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoKSwgMC4xLCB0cnVlKXRhc2sud2FpdCh0aW1ld2FpdCkKICAgIGlmIEZyYW1lMiB0aGVuCiAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIC0yMCwgMCwgMCksIDAuMSwgdHJ1ZSkKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgTWVudV9Ob3RpZmkuU2l6ZS5YLk9mZnNldCwgMCwgMCksIDAuNSwgdHJ1ZSkKICAgICAgRnJhbWUxOkRlc3Ryb3koKQogICAgZW5kCiAgZW5kKQplbmQKCmZ1bmN0aW9uIE1ha2VXaW5kb3coQ29uZmlncykKICBsb2NhbCB0aXRsZSA9IENvbmZpZ3MuSHViLlRpdGxlIG9yICJSRUR6IEhVQiIKICBsb2NhbCBBbmltX1RpdGxlID0gQ29uZmlncy5IdWIuQW5pbWF0aW9uIG9yICJieSA6IHJlZHo5OTk5IgogIAogIGxvY2FsIEtleVN5c3RlbSA9IENvbmZpZ3MuS2V5LktleVN5c3RlbSBvciBmYWxzZQogIGxvY2FsIEtleVRpdGxlID0gQ29uZmlncy5LZXkuVGl0bGUgb3IgIktleSBTeXN0ZW0iCiAgbG9jYWwgS2V5RGVzY3JpcHRpb24gPSBDb25maWdzLktleS5EZXNjcmlwdGlvbiBvciAiLi0uIgogIGxvY2FsIEtleUtleSA9IENvbmZpZ3MuS2V5LktleXMgb3IgeyIxMjMiLCAiMzIxIn0KICBsb2NhbCBLZXlMaW5rID0gQ29uZmlncy5LZXkuS2V5TGluayBvciAiIgogIGxvY2FsIEtleU5vdGlmaWNhdGlvbnMgPSBDb25maWdzLktleS5Ob3RpZmkuTm90aWZpY2F0aW9ucyBvciB0cnVlCiAgbG9jYWwgS2V5Tm90U3VjY2VzcyA9IENvbmZpZ3MuS2V5Lk5vdGlmaS5JbmNvcnJlY3RrZXkgb3IgIlRoZSBrZXkgaXMgaW5jb3JyZWN0IgogIGxvY2FsIEtleVN1Y2Nlc3MgPSBDb25maWdzLktleS5Ob3RpZmkuQ29ycmVjdEtleSBvciAiUnVubmluZyB0aGUgU2NyaXB0Li4uIgogIGxvY2FsIEtleUNvcHlLZXlMaW5rID0gQ29uZmlncy5LZXkuTm90aWZpLkNvcHlLZXlMaW5rIG9yICJDb3BpZWQgdG8gQ2xpcGJvYXJkIgogIAogIGlmIEtleVN5c3RlbSB0aGVuCiAgICBsb2NhbCBLZXlNZW51ID0gQ3JlYXRlKCJGcmFtZSIsIFNjcmVlbkd1aSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDQwMCwgMCwgMjIwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAwLjUsIDApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YiwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSksCiAgICAgIEFjdGl2ZSA9IHRydWUsCiAgICAgIERyYWdnYWJsZSA9IHRydWUKICAgIH0pQ29ybmVyKEtleU1lbnUpCiAgICAKICAgIGxvY2FsIENsb3NlQnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgS2V5TWVudSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDMwLCAwLCAzMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIC0xMCwgMCwgNSksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCksCiAgICAgIFRleHQgPSAiWCIsCiAgICAgIEZvbnQgPSBFbnVtLkZvbnQuRnJlZG9rYU9uZSwKICAgICAgVGV4dFNjYWxlZCA9IHRydWUsCiAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigyNDAsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIH0pQ29ybmVyKENsb3NlQnV0dG9uKQogICAgCiAgICBsb2NhbCBUaXRsZSA9IENyZWF0ZSgiVGV4dExhYmVsIiwgS2V5TWVudSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIC04MCwgMCwgMjApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyMCwgMCwgNSksCiAgICAgIFRleHQgPSBLZXlUaXRsZSwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dFNjYWxlZCA9IHRydWUsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBEZXNjcmlwdGlvbiA9IENyZWF0ZSgiVGV4dExhYmVsIiwgS2V5TWVudSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIC04MCwgMCwgMCksCiAgICAgIFRleHQgPSBLZXlEZXNjcmlwdGlvbiwKICAgICAgVGV4dFNpemUgPSAxNywKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9EYXJrVGV4dCwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMjAsIDAsIDI1KSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEF1dG9tYXRpY1NpemUgPSAiWSIsCiAgICAgIFRleHRZQWxpZ25tZW50ID0gIlRvcCIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBDb25maXJtQnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgS2V5TWVudSwgewogICAgICBUZXh0ID0gIk9rYXkiLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgICBUZXh0U2l6ZSA9IDIwLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTUwLCAwLCA0MCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIC0zNSwgMCwgMTQwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zCiAgICB9KUNvcm5lcihDb25maXJtQnV0dG9uKQogICAgCiAgICBsb2NhbCBHZXRLZXlMaW5rID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgS2V5TWVudSwgewogICAgICBUZXh0ID0gIkzhuqV5IGxpbmsga2V5IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dFNpemUgPSAyMCwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBTaXplID0gVURpbTIubmV3KDAsIDE1MCwgMCwgNDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNSwgMCwgMTQwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zCiAgICB9KUNvcm5lcihHZXRLZXlMaW5rKQogICAgCiAgICBsb2NhbCBUZXh0Qm94ID0gQ3JlYXRlKCJUZXh0Qm94IiwgS2V5TWVudSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIC03MCwgMCwgNDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNSwgMCwgOTApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIFBsYWNlaG9sZGVyVGV4dCA9ICJEw6FuIHbDtCDEkcOieSBuw6ggdGjhurFuZyBuZ3UiLAogICAgICBUZXh0ID0gIiIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dFNpemUgPSAyNQogICAgfSlDb3JuZXIoVGV4dEJveCkKICAgIAogICAgbG9jYWwgS2V5VmVyaWZ5ID0gZmFsc2UKICAgIENsb3NlQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBsb2NhbCBVSVNjYWxlID0gQ3JlYXRlKCJVSVNjYWxlIiwgU2NyZWVuR3VpKQogICAgICBDcmVhdGVUd2VlbihVSVNjYWxlLCAiU2NhbGUiLCAwLCAwLjIwLCB0cnVlKQogICAgICBTY3JlZW5HdWk6RGVzdHJveSgpCiAgICBlbmQpCiAgICAKICAgIENvbmZpcm1CdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGZvciBfLHYgaW4gcGFpcnMoS2V5S2V5KSBkbwogICAgICAgIGlmIFRleHRCb3guVGV4dCA9PSB2IHRoZW4KICAgICAgICAgIEtleVZlcmlmeSA9IHRydWUKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIGlmIEtleU5vdGlmaWNhdGlvbnMgYW5kIG5vdCBLZXlWZXJpZnkgdGhlbgogICAgICAgIE1ha2VOb3RpZmkoewogICAgICAgICAgVGl0bGUgPSBLZXlUaXRsZSwKICAgICAgICAgIFRleHQgPSBLZXlOb3RTdWNjZXNzLAogICAgICAgICAgVGltZSA9IDUKICAgICAgICB9KQogICAgICBlbHNlaWYgS2V5Tm90aWZpY2F0aW9ucyB0aGVuCiAgICAgICAgTWFrZU5vdGlmaSh7CiAgICAgICAgICBUaXRsZSA9IEtleVRpdGxlLAogICAgICAgICAgVGV4dCA9IEtleVN1Y2Nlc3MsCiAgICAgICAgICBUaW1lID0gNQogICAgICAgIH0pCiAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICBHZXRLZXlMaW5rLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBpZiBLZXlOb3RpZmljYXRpb25zIHRoZW4KICAgICAgICBzZXRjbGlwYm9hcmQoS2V5TGluaykKICAgICAgICBNYWtlTm90aWZpKHsKICAgICAgICAgIFRpdGxlID0gS2V5VGl0bGUsCiAgICAgICAgICBUZXh0ID0gS2V5Q29weUtleUxpbmssCiAgICAgICAgICBUaW1lID0gNQogICAgICAgIH0pCiAgICAgIGVuZAogICAgZW5kKQogICAgCiAgICByZXBlYXQgdGFzay53YWl0KCkKICAgIHVudGlsIEtleVZlcmlmeQogICAgbG9jYWwgVUlTY2FsZSA9IENyZWF0ZSgiVUlTY2FsZSIsIEtleU1lbnUpCiAgICBDcmVhdGVUd2VlbihVSVNjYWxlLCAiU2NhbGUiLCAwLCAwLjQwLCB0cnVlKQogICAgS2V5TWVudTpEZXN0cm95KCkKICBlbmQKICAKICBsb2NhbCBNZW51ID0gQ3JlYXRlKCJGcmFtZSIsIFNjcmVlbkd1aSwgewogICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIC01MDAvMiwgMC41LCAtMjcwLzIpLAogICAgQWN0aXZlID0gdHJ1ZSwKICAgIERyYWdnYWJsZSA9IHRydWUKICB9KUNvcm5lcihNZW51KQogIAogIGxvY2FsIFRvcEJhciA9IENyZWF0ZSgiRnJhbWUiLCBNZW51LCB7CiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgVmlzaWJsZSA9IGZhbHNlCiAgfSkKICAKICBsb2NhbCBCdXR0b25zRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgVG9wQmFyLCB7CiAgICBTaXplID0gVURpbTIubmV3KDAsIDQwLCAxLCAtNSksCiAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtMTAsIDAsIDIuNSksCiAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDEsIDApLAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICB9KQogIAogIGxvY2FsIFRpdGxlID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBUb3BCYXIsIHsKICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyMCwgMCwgMCksCiAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICBUZXh0ID0gdGl0bGUsCiAgICBUZXh0U2l6ZSA9IDIwLAogICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICB9KQogIAogIGxvY2FsIE1pbmltaXplX0JUTiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEJ1dHRvbnNGcmFtZSwgewogICAgVGV4dCA9ICItIiwKICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgIFNpemUgPSBVRGltMi5uZXcoMC41LCAwLCAxLCAwKSwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgIFRleHRZQWxpZ25tZW50ID0gIkJvdHRvbSIsCiAgICBUZXh0U2l6ZSA9IDI1CiAgfSkKICAKICBJc01pbmltaXplZCA9IGZhbHNlCiAgTWluaW1pemVfQlROLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgTWluaW1pemVfQlROLlRleHQgPSBub3QgSXNNaW5pbWl6ZWQgYW5kICIrIiBvciAiLSIKICAgIGlmIElzTWluaW1pemVkIHRoZW4KICAgICAgSXNNaW5pbWl6ZWQgPSBmYWxzZQogICAgICBDcmVhdGVUd2VlbihNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygwLCA1MDAsIDAsIDI3MCksIDAuMTUsIGZhbHNlKQogICAgZWxzZQogICAgICBJc01pbmltaXplZCA9IHRydWUKICAgICAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAyNSksIDAuMTUsIHRydWUpCiAgICBlbmQKICBlbmQpCiAgCiAgbG9jYWwgQ2xvc2VfQnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgQnV0dG9uc0ZyYW1lLCB7CiAgICBUZXh0ID0gIsOXIiwKICAgIFRleHRZQWxpZ25tZW50ID0gIkJvdHRvbSIsCiAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICBTaXplID0gVURpbTIubmV3KDAuNSwgMCwgMSwgMCksCiAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDEsIDApLAogICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMSwgMCwgMCwgMCksCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICBUZXh0U2l6ZSA9IDI1CiAgfSkKICAKICBsb2NhbCBmdW5jdGlvbiBDcmVhdGVDbG9zZSgpCiAgICBJc01pbmltaXplZCA9IGZhbHNlCiAgICBDcmVhdGVUd2VlbihNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygwLCA1MDAsIDAsIDI3MCksIDAuMywgZmFsc2UpCiAgICBsb2NhbCBDbG9zZUd1aSA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIE1lbnUsIHsKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuNSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICAgIEF1dG9CdXR0b25Db2xvciA9IGZhbHNlLAogICAgICBUZXh0ID0gIiIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjUsCiAgICAgIFZpc2libGUgPSBmYWxzZQogICAgfSlDb3JuZXIoQ2xvc2VHdWkpCiAgICAKICAgIGxvY2FsIENsb3NlTWVudSA9IENyZWF0ZSgiRnJhbWUiLCBDbG9zZUd1aSwgewogICAgICBTaXplID0gVURpbTIubmV3KCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNSwgMCksCiAgICAgIFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfSHViCiAgICB9KUNvcm5lcihDbG9zZU1lbnUpU3Ryb2tlKENsb3NlTWVudSkKICAgIAogICAgbG9jYWwgTWVuc2FnZSA9IENyZWF0ZSgiVGV4dExhYmVsIiwgQ2xvc2VNZW51LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMC44LCAwLCAwLjI1LCAwKSwKICAgICAgVGV4dCA9ICJNw6B5IG114buRbiDEkcOzbmcgc2NyaXB0IT8iLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjEsIDAsIDAuMiksCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udCwKICAgICAgVGV4dFNjYWxlZCA9IHRydWUsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBDb25maXJtID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgQ2xvc2VNZW51LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMC4zNSwgMCwgMC4zLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC4xLCAwLCAwLjUsIDApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YiwKICAgICAgVGV4dCA9ICLEkMOzbmciLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjQwLCAwLCAwKSwKICAgICAgVGV4dFNpemUgPSAyMAogICAgfSlDb3JuZXIoQ29uZmlybSlTdHJva2UoQ29uZmlybSkKICAgIAogICAgbG9jYWwgQ2FuY2VsID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgQ2xvc2VNZW51LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMC4zNSwgMCwgMC4zLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC45LCAwLCAwLjUsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDEsIDApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0h1YiwKICAgICAgVGV4dCA9ICLEkMOpbyIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigwLCAyNDAsIDApLAogICAgICBUZXh0U2l6ZSA9IDIwCiAgICB9KUNvcm5lcihDYW5jZWwpU3Ryb2tlKENhbmNlbCkKICAgIAogICAgbG9jYWwgZnVuY3Rpb24gU2V0VmlzaWJsZSgpCiAgICAgIGlmIE1lbnUuU2l6ZS5ZLk9mZnNldCA+IDEwMCB0aGVuCiAgICAgICAgQ2xvc2VHdWkuVmlzaWJsZSA9IHRydWUKICAgICAgZWxzZQogICAgICAgIENsb3NlR3VpLlZpc2libGUgPSBmYWxzZQogICAgICBlbmQKICAgIGVuZAogICAgCiAgICBTZXRWaXNpYmxlKCkKICAgIE1lbnU6R2V0UHJvcGVydHlDaGFuZ2VkU2lnbmFsKCJTaXplIik6Q29ubmVjdChTZXRWaXNpYmxlKQogICAgCiAgICBDcmVhdGVUd2VlbihDbG9zZU1lbnUsICJUcmFuc3BhcmVuY3kiLCAwLCAwLjIsIGZhbHNlKQogICAgQ3JlYXRlVHdlZW4oQ2xvc2VNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygwLjcsIDAsIDAuNywgMCksIDAuMiwgZmFsc2UpCiAgICAKICAgIENhbmNlbC5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgQ3JlYXRlVHdlZW4oQ2xvc2VNZW51LCAiVHJhbnNwYXJlbmN5IiwgMSwgMC4zLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oQ2xvc2VNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygpLCAwLjIsIHRydWUpCiAgICAgIENsb3NlR3VpOkRlc3Ryb3koKQogICAgZW5kKQogICAgCiAgICBDb25maXJtLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBDbG9zZUd1aTpEZXN0cm95KCkKICAgICAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoKSwgMC4zLCB0cnVlKQogICAgICBEZXN0cm95U2NyaXB0KCkKICAgIGVuZCkKICAgIAogICAgQ2xvc2VHdWkuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIENyZWF0ZVR3ZWVuKENsb3NlTWVudSwgIlRyYW5zcGFyZW5jeSIsIDEsIDAuMywgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKENsb3NlTWVudSwgIlNpemUiLCBVRGltMi5uZXcoKSwgMC4yLCB0cnVlKQogICAgICBDbG9zZUd1aTpEZXN0cm95KCkKICAgIGVuZCkKICBlbmQKICAKICBDbG9zZV9CdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChDcmVhdGVDbG9zZSkKICAKICBsb2NhbCBBbmltTWVudSA9IENyZWF0ZSgiRnJhbWUiLCBTY3JlZW5HdWksIHsKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuNSwgMCwgMC41LCAwKSwKICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpLAogICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIKICB9KUNvcm5lcihBbmltTWVudSwge0Nvcm5lclJhZGl1cyA9IFVEaW0ubmV3KDAsIDYpfSkKICAKICBsb2NhbCBBbmltX0NyZWRpdHMgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEFuaW1NZW51LCB7CiAgICBUZXh0ID0gQW5pbV9UaXRsZSwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgIFZpc2libGUgPSBmYWxzZSwKICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICBUZXh0VHJhbnNwYXJlbmN5ID0gMSwKICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCAwKSwKICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgVGV4dFNpemUgPSAxNQogIH0pCiAgCiAgQ3JlYXRlVHdlZW4oQW5pbU1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDAsIDAsIDM1KSwgMC41LCB0cnVlKQogIENyZWF0ZVR3ZWVuKEFuaW1NZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygwLCAxNTAsIDAsIDM1KSwgMC41LCB0cnVlKQogIEFuaW1fQ3JlZGl0cy5WaXNpYmxlID0gdHJ1ZQogIHRhc2sud2FpdCgwLjUpCiAgZm9yIGkgPSAxLCAwLCAtMC4xIGRvIHRhc2sud2FpdCgpCiAgICBBbmltX0NyZWRpdHMuVGV4dFRyYW5zcGFyZW5jeSA9IGkKICBlbmQKICB0YXNrLndhaXQoMSkKICBmb3IgaSA9IDAsIDEsIDAuMSBkbyB0YXNrLndhaXQoKQogICAgQW5pbV9DcmVkaXRzLlRleHRUcmFuc3BhcmVuY3kgPSBpCiAgZW5kCiAgQW5pbV9DcmVkaXRzOkRlc3Ryb3koKQogIEFuaW1NZW51OkRlc3Ryb3koKQogIENyZWF0ZVR3ZWVuKE1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDUwMCwgMCwgMzUpLCAwLjUsIHRydWUpCiAgVG9wQmFyLlZpc2libGUgPSB0cnVlCiAgQ3JlYXRlVHdlZW4oTWVudSwgIlNpemUiLCBVRGltMi5uZXcoMCwgNTAwLCAwLCAyNzApLCAwLjMsIHRydWUpCiAgTWVudS5EcmFnZ2FibGUgPSB0cnVlCiAgCiAgbG9jYWwgbGluZV9Db250YWluZXJzID0gQ3JlYXRlKCJGcmFtZSIsIE1lbnUsIHsKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKQogIH0pCiAgCiAgZnVuY3Rpb24gTWluaW1pemVCdXR0b24oQ29uZmlncykKICAgIGxvY2FsIGltYWdlID0gQ29uZmlncy5JbWFnZSBvciAiIgogICAgbG9jYWwgc2l6ZSA9IENvbmZpZ3MuU2l6ZSBvciB7MzAsIDMwfQogICAgbG9jYWwgY29sb3IgPSBDb25maWdzLkNvbG9yIG9yIENvbmZpZ3NfSFVCLkNvcl9IdWIKICAgIGxvY2FsIGNvcm5lciA9IENvbmZpZ3MuQ29ybmVyIG9yIHRydWUKICAgIGxvY2FsIHN0cm9rZSA9IENvbmZpZ3MuU3Ryb2tlIG9yIGZhbHNlCiAgICBsb2NhbCBzdHJva2Vjb2xvciA9IENvbmZpZ3MuU3Ryb2tlQ29sb3Igb3IgQ29uZmlnc19IVUIuQ29yX1N0cm9rZQogICAgCiAgICBsb2NhbCBCdXR0b24gPSBDcmVhdGUoIkltYWdlQnV0dG9uIiwgU2NyZWVuR3VpLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgc2l6ZVsxXSwgMCwgc2l6ZVsyXSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAuMTUsIDAsIDAuMTUsIDApLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gY29sb3IsCiAgICAgIEltYWdlID0gaW1hZ2UsCiAgICAgIEFjdGl2ZSA9IHRydWUsCiAgICAgIERyYWdnYWJsZSA9IHRydWUKICAgIH0paWYgY29ybmVyIHRoZW4gQ29ybmVyKEJ1dHRvbikgZW5kIGlmIHN0cm9rZSB0aGVuIFN0cm9rZShCdXR0b24sIHtDb2xvciA9IHN0cm9rZWNvbG9yfSkgZW5kCiAgICAKICAgIGxvY2FsIG1pbmltaXplID0gZmFsc2UKICAgIEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgaWYgbWluaW1pemUgdGhlbgogICAgICAgIG1pbmltaXplID0gZmFsc2UKICAgICAgICBNZW51LlZpc2libGUgPSB0cnVlCiAgICAgICAgaWYgbm90IElzTWluaW1pemVkIHRoZW4KICAgICAgICAgIENyZWF0ZVR3ZWVuKE1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDUwMCwgMCwgMjcwKSwgMC4zLCBmYWxzZSkKICAgICAgICBlbHNlCiAgICAgICAgICBDcmVhdGVUd2VlbihNZW51LCAiU2l6ZSIsIFVEaW0yLm5ldygwLCA1MDAsIDAsIDI1KSwgMC4zLCBmYWxzZSkKICAgICAgICBlbmQKICAgICAgZWxzZQogICAgICAgIG1pbmltaXplID0gdHJ1ZQogICAgICAgIENyZWF0ZVR3ZWVuKE1lbnUsICJTaXplIiwgVURpbTIubmV3KDAsIDUwMCwgMCwgMCksIDAuMywgdHJ1ZSkKICAgICAgICBNZW51LlZpc2libGUgPSBmYWxzZQogICAgICBlbmQKICAgIGVuZCkKICBlbmQKICAKICBsb2NhbCBTY3JvbGxCYXIgPSBDcmVhdGUoIlNjcm9sbGluZ0ZyYW1lIiwgTWVudSwgewogICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxNDAsIDEsIC10b251bWJlcihUb3BCYXIuU2l6ZS5ZLk9mZnNldCArIDIpKSwKICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDEsIDApLAogICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLCAxKSwKICAgIENhbnZhc1NpemUgPSBVRGltMi5uZXcoKSwKICAgIFNjcm9sbGluZ0RpcmVjdGlvbiA9ICJZIiwKICAgIEF1dG9tYXRpY0NhbnZhc1NpemUgPSAiWSIsCiAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgIFNjcm9sbEJhclRoaWNrbmVzcyA9IDIKICB9KUNyZWF0ZSgiVUlQYWRkaW5nIiwgU2Nyb2xsQmFyLCB7CiAgICBQYWRkaW5nTGVmdCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgIFBhZGRpbmdSaWdodCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgIFBhZGRpbmdUb3AgPSBVRGltLm5ldygwLCAxMCksCiAgICBQYWRkaW5nQm90dG9tID0gVURpbS5uZXcoMCwgMTApCiAgfSlDcmVhdGUoIlVJTGlzdExheW91dCIsIFNjcm9sbEJhciwgewogICAgUGFkZGluZyA9IFVEaW0ubmV3KDAsIDUpCiAgfSkKICAKICBsb2NhbCBDb250YWluZXJzID0gQ3JlYXRlKCJGcmFtZSIsIE1lbnUsIHsKICAgIFNpemUgPSBVRGltMi5uZXcoMSwgLXRvbnVtYmVyKFNjcm9sbEJhci5TaXplLlguT2Zmc2V0ICsgMiksIDEsIC10b251bWJlcihUb3BCYXIuU2l6ZS5ZLk9mZnNldCArIDIpKSwKICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMSksCiAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgfSlDb3JuZXIoQ29udGFpbmVycykKICAKICBsb2NhbCBmdW5jdGlvbiBBZGRfTGluZShwcm9wcykKICAgIGxvY2FsIGxpbmUgPSBDcmVhdGUoIkZyYW1lIiwgbGluZV9Db250YWluZXJzLCBwcm9wcykKICAgIGxpbmUuQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9TdHJva2UKICAgIGxpbmUuQm9yZGVyU2l6ZVBpeGVsID0gMAogIGVuZAogIAogIEFkZF9MaW5lKHtTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDEpLFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIFRvcEJhci5TaXplLlkuT2Zmc2V0KX0pCiAgQWRkX0xpbmUoe1NpemUgPSBVRGltMi5uZXcoMCwgMSwgMSwgLXRvbnVtYmVyKFRvcEJhci5TaXplLlkuT2Zmc2V0ICsgMSkpLAogIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIFNjcm9sbEJhci5TaXplLlguT2Zmc2V0LCAwLCBUb3BCYXIuU2l6ZS5ZLk9mZnNldCl9KQogIAogIGxvY2FsIGZpcnN0VmlzaWJsZSA9IHRydWUKICBsb2NhbCBGaXJzdFRhYiA9IHRydWUKICBsb2NhbCB0ZXh0c2l6ZSA9IDE1CiAgbG9jYWwgdGV4dGNvbG9yID0gQ29uZmlnc19IVUIuQ29yX1RleHQKICAKICBNZW51OkdldFByb3BlcnR5Q2hhbmdlZFNpZ25hbCgiU2l6ZSIpOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgaWYgTWVudS5TaXplLlkuT2Zmc2V0ID4gNzAgdGhlbgogICAgICBTY3JvbGxCYXIuVmlzaWJsZSA9IHRydWUKICAgICAgQ29udGFpbmVycy5WaXNpYmxlID0gdHJ1ZQogICAgICBsaW5lX0NvbnRhaW5lcnMuVmlzaWJsZSA9IHRydWUKICAgIGVsc2UKICAgICAgU2Nyb2xsQmFyLlZpc2libGUgPSBmYWxzZQogICAgICBDb250YWluZXJzLlZpc2libGUgPSBmYWxzZQogICAgICBsaW5lX0NvbnRhaW5lcnMuVmlzaWJsZSA9IGZhbHNlCiAgICBlbmQKICBlbmQpCiAgCiAgZnVuY3Rpb24gTWFrZVRhYihDb25maWdzKQogICAgbG9jYWwgVGFiTmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiVGFiIgogICAgbG9jYWwgVGFiVGl0bGUgPSBDb25maWdzLlRhYlRpdGxlIG9yIGZhbHNlCiAgICAKICAgIGxvY2FsIEZyYW1lID0gQ3JlYXRlKCJGcmFtZSIsIFNjcm9sbEJhciwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pQ29ybmVyKEZyYW1lKVN0cm9rZShGcmFtZSkKICAgIAogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0ID0gIiIKICAgIH0pCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgRnJhbWUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRDb2xvcjMgPSB0ZXh0Y29sb3IsCiAgICAgIFRleHRTaXplID0gdGV4dHNpemUsCiAgICAgIFRleHQgPSBUYWJOYW1lCiAgICB9KQogICAgCiAgICBsb2NhbCBDb250YWluZXIgPSBDcmVhdGUoIlNjcm9sbGluZ0ZyYW1lIiwgQ29udGFpbmVycywgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBTY3JvbGxpbmdEaXJlY3Rpb24gPSAiWSIsCiAgICAgIEF1dG9tYXRpY0NhbnZhc1NpemUgPSAiWSIsCiAgICAgIENhbnZhc1NpemUgPSBVRGltMi5uZXcoKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFNjcm9sbEJhclRoaWNrbmVzcyA9IDIsCiAgICAgIFZpc2libGUgPSBmaXJzdFZpc2libGUKICAgIH0pQ3JlYXRlKCJVSVBhZGRpbmciLCBDb250YWluZXIsIHsKICAgICAgUGFkZGluZ0xlZnQgPSBVRGltLm5ldygwLCAxMCksCiAgICAgIFBhZGRpbmdSaWdodCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgICAgUGFkZGluZ1RvcCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgICAgUGFkZGluZ0JvdHRvbSA9IFVEaW0ubmV3KDAsIDEwKQogICAgfSlDcmVhdGUoIlVJTGlzdExheW91dCIsIENvbnRhaW5lciwgewogICAgICBQYWRkaW5nID0gVURpbS5uZXcoMCwgNSkKICAgIH0pCiAgICAKICAgIGlmIFRhYlRpdGxlIHRoZW4KICAgICAgQ3JlYXRlKCJUZXh0TGFiZWwiLENvbnRhaW5lcix7QmFja2dyb3VuZFRyYW5zcGFyZW5jeT0xLFRleHQ9IiMiLi5zdHJpbmcuZ3N1YihUYWJOYW1lLCIgIiwiLSIpLFRleHRTaXplPTI1LEZvbnQ9Q29uZmlnc19IVUIuVGV4dF9Gb250LFRleHRYQWxpZ25tZW50PSJMZWZ0IixUZXh0Q29sb3IzPUNvbmZpZ3NfSFVCLkNvcl9UZXh0LFNpemU9VURpbTIubmV3KDEsIDAsIDAsIDMwKSxQb3NpdGlvbj1VRGltMi5uZXcoMCwgMzAsIDAsIDApLE5hbWU9IkZyYW1lIn0pCiAgICBlbmQKICAgIAogICAgVGV4dEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgZm9yIF8sY29udGFpbmVyIGluIHBhaXJzKENvbnRhaW5lcnM6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiBjb250YWluZXI6SXNBKCJTY3JvbGxpbmdGcmFtZSIpIHRoZW4KICAgICAgICAgIGNvbnRhaW5lci5WaXNpYmxlID0gZmFsc2UKICAgICAgICBlbmQKICAgICAgZW5kCiAgICAgIGZvciBfLGZyYW1lIGluIHBhaXJzKFNjcm9sbEJhcjpHZXRDaGlsZHJlbigpKSBkbwogICAgICAgIGlmIGZyYW1lOklzQSgiRnJhbWUiKSBhbmQgZnJhbWU6RmluZEZpcnN0Q2hpbGQoIlRleHRMYWJlbCIpIGFuZCBmcmFtZS5UZXh0TGFiZWwgfj0gVGV4dExhYmVsIHRoZW4KICAgICAgICAgIENyZWF0ZVR3ZWVuKGZyYW1lLlRleHRMYWJlbCwgIlRleHRDb2xvcjMiLCBDb25maWdzX0hVQi5Db3JfRGFya1RleHQsIDAuMywgZmFsc2UpCiAgICAgICAgICBmcmFtZS5UZXh0TGFiZWwuVGV4dFNpemUgPSAxNAogICAgICAgIGVuZAogICAgICBlbmQKICAgICAgQ29udGFpbmVyLlZpc2libGUgPSB0cnVlCiAgICAgIENyZWF0ZVR3ZWVuKFRleHRMYWJlbCwgIlRleHRDb2xvcjMiLCBDb25maWdzX0hVQi5Db3JfVGV4dCwgMC4zLCBmYWxzZSkKICAgICAgVGV4dExhYmVsLlRleHRTaXplID0gMTUKICAgIGVuZCkKICAgIAogICAgZmlyc3RWaXNpYmxlID0gZmFsc2UKICAgIEZpcnN0VGFiID0gZmFsc2UKICAgIHRleHRzaXplID0gMTQKICAgIHRleHRjb2xvciA9IENvbmZpZ3NfSFVCLkNvcl9EYXJrVGV4dAogICAgcmV0dXJuIENvbnRhaW5lcgogIGVuZAogIAogIGZ1bmN0aW9uIEFkZEJ1dHRvbihwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBCdXR0b25OYW1lID0gQ29uZmlncy5OYW1lIG9yICJCdXR0b24hISIKICAgIGxvY2FsIENhbGxiYWNrID0gQ29uZmlncy5DYWxsYmFjayBvciBmdW5jdGlvbigpIGVuZAogICAgCiAgICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIE5hbWUgPSAiRnJhbWUiLAogICAgICBUZXh0ID0gIiIsCiAgICAgIEF1dG9CdXR0b25Db2xvciA9IGZhbHNlCiAgICB9KUNvcm5lcihUZXh0QnV0dG9uKVN0cm9rZShUZXh0QnV0dG9uKQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIFRleHRCdXR0b24sIHsKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gQnV0dG9uTmFtZSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQKICAgIH0pCiAgICAKICAgIGxvY2FsIEltYWdlTGFiZWwgPSBDcmVhdGUoIkltYWdlTGFiZWwiLCBUZXh0QnV0dG9uLCB7CiAgICAgIEltYWdlID0gInJieGFzc2V0aWQ6Ly8xNTE1NTIxOTQwNSIsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMjAsIDAsIDIwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNSwgMCwgMi41KSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEltYWdlQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1N0cm9rZQogICAgfSkKICAgIAogICAgVGV4dEJ1dHRvbi5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgQ2FsbGJhY2soIkNsaWNrISEiKQogICAgICBDcmVhdGVUd2VlbihJbWFnZUxhYmVsLCAiSW1hZ2VDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIHRydWUpCiAgICAgIENyZWF0ZVR3ZWVuKEltYWdlTGFiZWwsICJJbWFnZUNvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsIDAuMiwgZmFsc2UpCiAgICBlbmQpCiAgICAKICAgIFRleHRTZXRDb2xvcihUZXh0TGFiZWwpCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkVG9nZ2xlKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIFRvZ2dsZU5hbWUgPSBDb25maWdzLk5hbWUgb3IgIlRvZ2dsZSEhIgogICAgbG9jYWwgRGVmYXVsdCA9IENvbmZpZ3MuRGVmYXVsdCBvciBmYWxzZQogICAgbG9jYWwgQ2FsbGJhY2sgPSBDb25maWdzLkNhbGxiYWNrIG9yIGZ1bmN0aW9uKCkgZW5kCiAgICAKICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIsCiAgICAgIFRleHQgPSAiIiwKICAgICAgQXV0b0J1dHRvbkNvbG9yID0gZmFsc2UKICAgIH0pQ29ybmVyKFRleHRCdXR0b24pU3Ryb2tlKFRleHRCdXR0b24pCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dExhYmVsIiwgVGV4dEJ1dHRvbiwgewogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHQgPSBUb2dnbGVOYW1lLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAzNSwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSkKICAgIAogICAgbG9jYWwgRnJhbWUxID0gQ3JlYXRlKCJGcmFtZSIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAyNSwgMCwgMTUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA1LCAwLCA1KSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICB9KUNvcm5lcihGcmFtZTEsIHtDb3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKX0pCiAgICBsb2NhbCBTdHJva2UgPSBTdHJva2UoRnJhbWUxLCB7VGhpY2tuZXNzID0gMn0pCiAgICAKICAgIGxvY2FsIEZyYW1lMiA9IENyZWF0ZSgiRnJhbWUiLCBGcmFtZTEsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMywgMCwgMTMpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyLCAwLjUsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAsIDAuNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfU3Ryb2tlCiAgICB9KUNvcm5lcihGcmFtZTIsIHtDb3JuZXJSYWRpdXMgPSBVRGltLm5ldygxLCAwKX0pCiAgICAKICAgIGxvY2FsIE9uT2ZmID0gZmFsc2UKICAgIGlmIERlZmF1bHQgdGhlbgogICAgICBPbk9mZiA9IHRydWUKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgMTAsIDAuNSwgMCksIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIkJhY2tncm91bmRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgICBDcmVhdGVUd2VlbihTdHJva2UsICJDb2xvciIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKFRleHRMYWJlbCwgIlRleHRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgZW5kCiAgICBDYWxsYmFjayhPbk9mZikKICAgIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGlmIEZyYW1lMi5Qb3NpdGlvbi5YLk9mZnNldCA8IDUgdGhlbgogICAgICAgIE9uT2ZmID0gdHJ1ZQogICAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIDEwLCAwLjUsIDApLCAwLjIsIGZhbHNlKQogICAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIkJhY2tncm91bmRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgICAgIENyZWF0ZVR3ZWVuKFN0cm9rZSwgIkNvbG9yIiwgQ29sb3IzLmZyb21SR0IoMjgsIDEyMCwgMjEyKSwgMC4yLCBmYWxzZSkKICAgICAgICBDcmVhdGVUd2VlbihUZXh0TGFiZWwsICJUZXh0Q29sb3IzIiwgQ29sb3IzLmZyb21SR0IoMjgsIDEyMCwgMjEyKSwgMC4yLCBmYWxzZSkKICAgICAgICBDYWxsYmFjayh0cnVlKQogICAgICBlbHNlCiAgICAgICAgT25PZmYgPSBmYWxzZQogICAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIDIsIDAuNSwgMCksIDAuMiwgZmFsc2UpCiAgICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiQmFja2dyb3VuZENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsIDAuMiwgZmFsc2UpCiAgICAgICAgQ3JlYXRlVHdlZW4oU3Ryb2tlLCAiQ29sb3IiLCBDb25maWdzX0hVQi5Db3JfU3Ryb2tlLCAwLjIsIGZhbHNlKQogICAgICAgIENyZWF0ZVR3ZWVuKFRleHRMYWJlbCwgIlRleHRDb2xvcjMiLCBDb25maWdzX0hVQi5Db3JfVGV4dCwgMC4yLCBmYWxzZSkKICAgICAgICBDYWxsYmFjayhmYWxzZSkKICAgICAgZW5kCiAgICBlbmQpCiAgICByZXR1cm4ge0ZyYW1lMiwgU3Ryb2tlLCBPbk9mZiwgQ2FsbGJhY2t9CiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkTW9iaWxlVG9nZ2xlKENvbmZpZ3MpCiAgICBsb2NhbCBuYW1lID0gQ29uZmlncy5OYW1lIG9yICJBdGFsaG8iCiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIGxvY2FsIHZpc2libGUgPSBDb25maWdzLlZpc2libGUgb3IgZmFsc2UKICAgIAogICAgbG9jYWwgVG9nZ2xlX0F0YWxobyA9IENyZWF0ZSgiRnJhbWUiLCBTY3JlZW5HdWksIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMDAsIDAsIDYwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC44LCAwLCAwLjgsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAuNSwgMC41KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9IdWIsCiAgICAgIERyYWdnYWJsZSA9IHRydWUsCiAgICAgIEFjdGl2ZSA9IHRydWUsCiAgICAgIFZpc2libGUgPSB2aXNpYmxlCiAgICB9KUNvcm5lcihUb2dnbGVfQXRhbGhvKQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIFRvZ2dsZV9BdGFsaG8sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyMCksCiAgICAgIFRleHRTaXplID0gMjAsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IG5hbWUsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBUb2dnbGVfQXRhbGhvLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgNDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAyMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0ID0gIiIKICAgIH0pCiAgICAKICAgIGxvY2FsIEZyYW1lID0gQ3JlYXRlKCJGcmFtZSIsIEJ1dHRvbiwgewogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDAuNSwgMCksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMC41LCAwLjUpLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIC00MCwgMSwgLTE1KSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pQ29ybmVyKEZyYW1lLCB7Q29ybmVyUmFkaXVzID0gVURpbS5uZXcoMiwgMCl9KQogICAgCiAgICBsb2NhbCBGcmFtZTIgPSBDcmVhdGUoIkZyYW1lIiwgRnJhbWUsIHsKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgNSwgMC41LCAwKSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLCAwLjUpLAogICAgICBTaXplID0gVURpbTIubmV3KDAsIDE3LCAwLCAxNyksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KUNvcm5lcihGcmFtZTIsIHtDb3JuZXJSYWRpdXMgPSBVRGltLm5ldyg1LCAwKX0pCiAgICAKICAgIGxvY2FsIHN0cm9rZSA9IFN0cm9rZShGcmFtZSwgewogICAgICBDb2xvciA9IENvbG9yMy5mcm9tUkdCKDEwMCwgMTAwLCAxMDApLAogICAgICBUaGlja25lc3MgPSAzCiAgICB9KQogICAgCiAgICBsb2NhbCBzdHJva2UgPSBTdHJva2UoRnJhbWUyLCB7CiAgICAgIENvbG9yID0gQ29sb3IzLmZyb21SR0IoMTAwLCAxMDAsIDEwMCksCiAgICAgIFRoaWNrbmVzcyA9IDMKICAgIH0pCiAgICAKICAgIGxvY2FsIE9uT2ZmID0gZmFsc2UKICAgIENhbGxiYWNrKE9uT2ZmKQogICAgQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBpZiBPbk9mZiA9PSBmYWxzZSB0aGVuCiAgICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMSwgLTIyLCAwLjUsIDApLCAwLjIsIGZhbHNlKQogICAgICBlbHNlCiAgICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgNSwgMC41LCAwKSwgMC4yLCBmYWxzZSkKICAgICAgZW5kCiAgICAgIE9uT2ZmID0gbm90IE9uT2ZmCiAgICAgIENhbGxiYWNrKE9uT2ZmKQogICAgZW5kKQogICAgCiAgICByZXR1cm4gVG9nZ2xlX0F0YWxobwogIGVuZAogIAogIGZ1bmN0aW9uIFVwZGF0ZVRvZ2dsZSh0b2dnbGUsIHZhbHVlKQogICAgbG9jYWwgRnJhbWUyID0gdG9nZ2xlWzFdCiAgICBsb2NhbCBTdHJva2UgPSB0b2dnbGVbMl0KICAgIGxvY2FsIE9uT2ZmID0gdmFsdWUKICAgIGxvY2FsIENhbGxiYWNrID0gdG9nZ2xlWzRdCiAgICAKICAgIGlmIE9uT2ZmIHRoZW4KICAgICAgQ2FsbGJhY2sodHJ1ZSkKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgMTAsIDAuNSwgMCksIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKEZyYW1lMiwgIkJhY2tncm91bmRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgICBDcmVhdGVUd2VlbihTdHJva2UsICJDb2xvciIsIENvbG9yMy5mcm9tUkdCKDI4LCAxMjAsIDIxMiksIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKFRleHRMYWJlbCwgIlRleHRDb2xvcjMiLCBDb2xvcjMuZnJvbVJHQigyOCwgMTIwLCAyMTIpLCAwLjIsIGZhbHNlKQogICAgZWxzZQogICAgICBDYWxsYmFjayhmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiUG9zaXRpb24iLCBVRGltMi5uZXcoMCwgMiwgMC41LCAwKSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oRnJhbWUyLCAiQmFja2dyb3VuZENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsIDAuMiwgZmFsc2UpCiAgICAgIENyZWF0ZVR3ZWVuKFN0cm9rZSwgIkNvbG9yIiwgQ29uZmlnc19IVUIuQ29yX1N0cm9rZSwgMC4yLCBmYWxzZSkKICAgICAgQ3JlYXRlVHdlZW4oVGV4dExhYmVsLCAiVGV4dENvbG9yMyIsIENvbmZpZ3NfSFVCLkNvcl9UZXh0LCAwLjIsIGZhbHNlKQogICAgZW5kCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkU2xpZGVyKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIFNsaWRlck5hbWUgPSBDb25maWdzLk5hbWUgb3IgIlNsaWRlciEhIgogICAgbG9jYWwgSW5jcmVhc2UgPSBDb25maWdzLkluY3JlYXNlIG9yIDEKICAgIGxvY2FsIE1pblZhbHVlID0gQ29uZmlncy5NaW5WYWx1ZSAvIEluY3JlYXNlIG9yIDEwIC8gSW5jcmVhc2UKICAgIGxvY2FsIE1heFZhbHVlID0gQ29uZmlncy5NYXhWYWx1ZSAvIEluY3JlYXNlIG9yIDEwMCAvIEluY3JlYXNlCiAgICBsb2NhbCBEZWZhdWx0ID0gQ29uZmlncy5EZWZhdWx0IG9yIDI1CiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIlRleHRCdXR0b24iLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIsCiAgICAgIFRleHQgPSAwCiAgICB9KUNvcm5lcihGcmFtZSlTdHJva2UoRnJhbWUpCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IFNsaWRlck5hbWUsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMSwgMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDE1MCwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSlUZXh0U2V0Q29sb3IoVGV4dExhYmVsKQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWxOdW1iZXIgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEZyYW1lLCB7CiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMjAsIDAsIDIwKSwKICAgICAgVGV4dCA9ICIuLi4iLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA1LCAwLCAyLjUpLAogICAgICBUZXh0U2NhbGVkID0gdHJ1ZSwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgfSkKICAgIAogICAgbG9jYWwgU2xpZGVyQmFyMSA9IENyZWF0ZSgiVGV4dExhYmVsIiwgRnJhbWUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMDAsIDAsIDcuNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDM1LCAwLjUsIDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAsIDAuNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfU3Ryb2tlLAogICAgICBUZXh0ID0gIiIKICAgIH0pQ29ybmVyKFNsaWRlckJhcjEpCiAgICAKICAgIGxvY2FsIFNhdmVQb3MgPSBDcmVhdGUoIkZyYW1lIiwgU2xpZGVyQmFyMSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDEsIDAsIDApLAogICAgICBWaXNpYmxlID0gZmFsc2UKICAgIH0pCiAgICAKICAgIGxvY2FsIFNsaWRlciA9IENyZWF0ZSgiRnJhbWUiLCBTbGlkZXJCYXIxLCB7CiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA3LjUsIDAsIDE1KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMCwgMC41LCAwKSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLCAwLjUpLAogICAgICBBY3RpdmUgPSB0cnVlLAogICAgICBEcmFnZ2FibGUgPSB0cnVlCiAgICB9KUNvcm5lcihTbGlkZXIpCiAgICAKICAgIGxvY2FsIFNsaWRlckJhcjIgPSBDcmVhdGUoIkZyYW1lIiwgU2xpZGVyQmFyMSwgewogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjgsIDEyMCwgMjEyKSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCBTbGlkZXIuUG9zaXRpb24uWC5PZmZzZXQsIDEsIDApCiAgICB9KUNvcm5lcihTbGlkZXJCYXIyKQogICAgCiAgICBsb2NhbCBmdW5jdGlvbiBVcGRDb3VudGVyKFZhbHVlKQogICAgICBsb2NhbCBTdHJpbmcgPSB0b3N0cmluZyhWYWx1ZSAqIEluY3JlYXNlKQogICAgICBpZiBzdHJpbmcuZmluZChTdHJpbmcsICIuIikgdGhlbgogICAgICAgIFN0cmluZyA9IFN0cmluZzpzdWIoMSwgNSkKICAgICAgZW5kCiAgICAgIFRleHRMYWJlbE51bWJlci5UZXh0ID0gU3RyaW5nCiAgICAgIENhbGxiYWNrKFZhbHVlICogSW5jcmVhc2UpCiAgICBlbmQKICAgIAogICAgbG9jYWwgTW91c2VFbnRlck9yTGVhdmUgPSBmYWxzZQogICAgRnJhbWUuTW91c2VCdXR0b24xRG93bjpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgTW91c2VFbnRlck9yTGVhdmUgPSB0cnVlCiAgICAgIHdoaWxlIE1vdXNlRW50ZXJPckxlYXZlIGRvIHRhc2sud2FpdCgpCiAgICAgICAgbG9jYWwgTW91c2VQb3MgPSBVc2VySW5wdXRTZXJ2aWNlOkdldE1vdXNlTG9jYXRpb24oKS5YIC0gU2F2ZVBvcy5BYnNvbHV0ZVBvc2l0aW9uLlgKICAgICAgICBTbGlkZXIuUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgTW91c2VQb3MsIDAuNSwgMCkKICAgICAgZW5kCiAgICBlbmQpCiAgICBGcmFtZS5Nb3VzZUxlYXZlOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBNb3VzZUVudGVyT3JMZWF2ZSA9IGZhbHNlCiAgICBlbmQpCiAgICAKICAgIGxvY2FsIGZ1bmN0aW9uIFNsaWRlclNldChOZXdWYWx1ZSkKICAgICAgbG9jYWwgbWF4LCBtaW4gPSBNYXhWYWx1ZSAqIEluY3JlYXNlLCBNaW5WYWx1ZSAqIEluY3JlYXNlCiAgICAgIGxvY2FsIFNsaWRlclBvcyA9IChOZXdWYWx1ZSAtIG1pbikgLyAobWF4IC0gbWluKQogICAgICBsb2NhbCBYX09mZnNldCA9IFNsaWRlclBvcyAqIDEwMAogICAgICBsb2NhbCBTbGlkZXJQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCBYX09mZnNldCArIDEsIDAsIDApCiAgICAgIENyZWF0ZVR3ZWVuKFNsaWRlciwgIlBvc2l0aW9uIiwgU2xpZGVyUG9zaXRpb24sIDAuNSwgZmFsc2UpCiAgICBlbmQKICAgIFNsaWRlclNldChEZWZhdWx0KQogICAgCiAgICBTbGlkZXIuQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKHByb3ApCiAgICAgIGlmIHByb3AgPT0gIlBvc2l0aW9uIiB0aGVuCiAgICAgICAgU2xpZGVyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIG1hdGguY2xhbXAoU2xpZGVyLlBvc2l0aW9uLlguT2Zmc2V0LCAwLCAxMDApLCAwLjUsIDApCiAgICAgICAgU2xpZGVyQmFyMi5TaXplID0gVURpbTIubmV3KDAsIFNsaWRlci5Qb3NpdGlvbi5YLk9mZnNldCwgMSwgMCkKICAgICAgICBsb2NhbCBTbGlkZXJQb3MgPSBTbGlkZXIuUG9zaXRpb24uWC5PZmZzZXQgLyAxMDAKICAgICAgICBsb2NhbCBBXzEgPSBtYXRoLmZsb29yKCgoU2xpZGVyUG9zICogTWF4VmFsdWUpIC8gTWF4VmFsdWUpICogKE1heFZhbHVlIC0gTWluVmFsdWUpICsgTWluVmFsdWUpCiAgICAgICAgVXBkQ291bnRlcihBXzEpCiAgICAgIGVuZAogICAgZW5kKQogICAgcmV0dXJuIHtTbGlkZXIsIEluY3JlYXNlLCBNYXhWYWx1ZSwgTWluVmFsdWV9CiAgZW5kCiAgCiAgZnVuY3Rpb24gVXBkYXRlU2xpZGVyKFNsaWRlciwgTmV3VmFsdWUpCiAgICBsb2NhbCBGcmFtZSA9IFNsaWRlclsxXQogICAgbG9jYWwgSW5jcmVhc2UgPSBTbGlkZXJbMl0KICAgIGxvY2FsIE1heCA9IFNsaWRlclszXSAqIEluY3JlYXNlCiAgICBsb2NhbCBNaW4gPSBTbGlkZXJbNF0gKiBJbmNyZWFzZQogICAgCiAgICBsb2NhbCBTbGlkZXJQb3MgPSAoTmV3VmFsdWUgLSBNaW4pIC8gKE1heCAtIE1pbikKICAgIGxvY2FsIFhfT2Zmc2V0ID0gU2xpZGVyUG9zICogMTAwCiAgICBsb2NhbCBTbGlkZXJQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCBYX09mZnNldCArIDEsIDAsIDApCiAgICBDcmVhdGVUd2VlbihGcmFtZSwgIlBvc2l0aW9uIiwgU2xpZGVyUG9zaXRpb24sIDAuNSwgZmFsc2UpCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkS2V5YmluZChwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBLZXliaW5kTmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiU2xpZGVyISEiCiAgICBsb2NhbCBLZXlDb2RlID0gQ29uZmlncy5LZXlDb2RlIG9yICJFIgogICAgbG9jYWwgRGVmYXVsdCA9IENvbmZpZ3MuRGVmYXVsdCBvciBmYWxzZQogICAgbG9jYWwgQ2FsbGJhY2sgPSBDb25maWdzLkNhbGxiYWNrIG9yIGZ1bmN0aW9uKCkgZW5kCiAgICAKICAgIGxvY2FsIEZyYW1lID0gQ3JlYXRlKCJGcmFtZSIsIHBhcmVudCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgICBOYW1lID0gIkZyYW1lIgogICAgfSlDb3JuZXIoRnJhbWUpU3Ryb2tlKEZyYW1lKQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRCdXR0b24iLCBGcmFtZSwgewogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHQgPSBLZXliaW5kTmFtZSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQKICAgIH0pCiAgICAKICAgIGxvY2FsIEtleWJpbmQgPSBDcmVhdGUoIlRleHRMYWJlbCIsIEZyYW1lLCB7CiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTgsIDAsIDE4KSwKICAgICAgVGV4dCA9IEtleUNvZGUsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDMuNSksCiAgICAgIFRleHRTY2FsZWQgPSB0cnVlLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KUNvcm5lcihLZXliaW5kKVN0cm9rZShLZXliaW5kKQogICAgCiAgICBsb2NhbCBPbk9mZiA9IERlZmF1bHQKICAgIFVzZXJJbnB1dFNlcnZpY2UuSW5wdXRCZWdhbjpDb25uZWN0KGZ1bmN0aW9uKGlucHV0KQogICAgICBpZiBpbnB1dC5LZXlDb2RlID09IEVudW0uS2V5Q29kZVtLZXlDb2RlXSB0aGVuCiAgICAgICAgT25PZmYgPSBub3QgT25PZmYKICAgICAgICBDYWxsYmFjayhPbk9mZikKICAgICAgZW5kCiAgICBlbmQpCiAgICBUZXh0U2V0Q29sb3IoVGV4dExhYmVsKQogIGVuZAogIAogIGZ1bmN0aW9uIEFkZFRleHRCb3gocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgVGV4dEJveE5hbWUgPSBDb25maWdzLk5hbWUgb3IgIlRleHRCb3ghISIKICAgIGxvY2FsIERlZmF1bHQgPSBDb25maWdzLkRlZmF1bHQgb3IgIlRleHRCb3giCiAgICBsb2NhbCBwbGFjZWhvbGRlclRleHQgPSBDb25maWdzLlBsYWNlaG9sZGVyVGV4dCBvciAiVGV4dEJveCIKICAgIGxvY2FsIENsZWFyVGV4dCA9IENvbmZpZ3MuQ2xlYXJUZXh0IG9yIGZhbHNlCiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIE5hbWUgPSAiRnJhbWUiCiAgICB9KUNvcm5lcihGcmFtZSlTdHJva2UoRnJhbWUpCiAgICAKICAgIGxvY2FsIFRleHRMYWJlbCA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IFRleHRCb3hOYW1lLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDEsIDApLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxNTAsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQKICAgIH0pCiAgICBUZXh0U2V0Q29sb3IoVGV4dExhYmVsKQogICAgCiAgICBsb2NhbCBUZXh0Qm94ID0gQ3JlYXRlKCJUZXh0Qm94IiwgRnJhbWUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAxMjAsIDAsIDIwKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMTUsIDAsIDIuNSksCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IERlZmF1bHQsCiAgICAgIENsZWFyVGV4dE9uRm9jdXMgPSBDbGVhclRleHQsCiAgICAgIFBsYWNlaG9sZGVyVGV4dCA9IHBsYWNlaG9sZGVyVGV4dCwKICAgICAgVGV4dFNjYWxlZCA9IHRydWUsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBMaW5lID0gQ3JlYXRlKCJGcmFtZSIsIFRleHRCb3gsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxKSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMC41LCAwLCAxLCAwKSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDAuNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfU3Ryb2tlLAogICAgICBCb3JkZXJTaXplUGl4ZWwgPSAwCiAgICB9KQogICAgCiAgICBUZXh0Qm94Lk1vdXNlRW50ZXI6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIENyZWF0ZVR3ZWVuKExpbmUsICJTaXplIiwgVURpbTIubmV3KDAsIDAsIDAsIDEpLCAwLjMsIHRydWUpCiAgICAgIENyZWF0ZVR3ZWVuKExpbmUsICJTaXplIiwgVURpbTIubmV3KDEsIDAsIDAsIDEpLCAwLjMsIHRydWUpCiAgICBlbmQpCiAgICAKICAgIFRleHRCb3guRm9jdXNMb3N0OkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBDYWxsYmFjayhUZXh0Qm94LlRleHQpCiAgICBlbmQpCiAgZW5kCiAgCiAgZnVuY3Rpb24gQWRkQ29sb3JQaWNrZXIocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgbmFtZSA9IENvbmZpZ3MuTmFtZSBvciAiQ29sb3IgUGlja2VyIgogICAgbG9jYWwgRGVmYXVsdCA9IENvbmZpZ3MuRGVmYXVsdCBvciBDb2xvcjMuZnJvbVJHQigwLCAwLCAyMDApCiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIGxvY2FsIENvbG9ySCwgQ29sb3JTLCBDb2xvclYgPSAxLCAxLCAxCiAgICBDYWxsYmFjayhEZWZhdWx0KQogICAgCiAgICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJGcmFtZSIsIHBhcmVudCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgfSlTdHJva2UoVGV4dEJ1dHRvbilDb3JuZXIoVGV4dEJ1dHRvbikKICAgIAogICAgbG9jYWwgY2xpY2sgPSBDcmVhdGUoIlRleHRCdXR0b24iLCBUZXh0QnV0dG9uLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgQXV0b0J1dHRvbkNvbG9yID0gZmFsc2UsCiAgICAgIFRleHQgPSAiIgogICAgfSkKICAgIAogICAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBUZXh0QnV0dG9uLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgLTEwLCAwLCAyNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDM1LCAwLCAwKSwKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgVGV4dCA9IG5hbWUsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICB9KQogICAgCiAgICBsb2NhbCBwaWNrZXIgPSBDcmVhdGUoIkZyYW1lIiwgVGV4dEJ1dHRvbiwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDIwLCAwLCAyMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDIuNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBEZWZhdWx0CiAgICB9KUNvcm5lcihwaWNrZXIpU3Ryb2tlKHBpY2tlcikKICAgIAogICAgbG9jYWwgVUlfR3JhZGUgPSBDcmVhdGUoIkltYWdlQnV0dG9uIiwgVGV4dEJ1dHRvbiwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIC0xMDAsIDEsIHRvbnVtYmVyKC1UZXh0QnV0dG9uLlNpemUuWS5PZmZzZXQgLSAyMCkpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxMCwgMCwgdG9udW1iZXIoVGV4dEJ1dHRvbi5TaXplLlkuT2Zmc2V0ICsgMTIuNSkpLAogICAgICBWaXNpYmxlID0gZmFsc2UsCiAgICAgIEltYWdlID0gInJieGFzc2V0aWQ6Ly80MTU1ODAxMjUyIgogICAgfSlDb3JuZXIoVUlfR3JhZGUpU3Ryb2tlKFVJX0dyYWRlKWxvY2FsIFNhdmVQb3MgPSBDcmVhdGUoIkZyYW1lIiwgVUlfR3JhZGUsIHtWaXNpYmxlID0gZmFsc2V9KQogICAgCiAgICBsb2NhbCBncmFkZSA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAzMCwgMSwgdG9udW1iZXIoLVRleHRCdXR0b24uU2l6ZS5ZLk9mZnNldCAtIDIwKSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDEsIC0xMCwgMCwgdG9udW1iZXIoVGV4dEJ1dHRvbi5TaXplLlkuT2Zmc2V0ICsgMTIuNSkpLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDEsIDApLAogICAgICBWaXNpYmxlID0gZmFsc2UsCiAgICAgIFRleHQgPSAiIgogICAgfSlDb3JuZXIoZ3JhZGUpU3Ryb2tlKGdyYWRlKUNyZWF0ZSgiVUlHcmFkaWVudCIsIGdyYWRlLCB7CiAgICAgIFJvdGF0aW9uID0gOTAsCiAgICAgIENvbG9yID0gQ29sb3JTZXF1ZW5jZS5uZXcoewogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC4wMCwgQ29sb3IzLmZyb21SR0IoMjU1LCAwLCA0KSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygwLjIwLCBDb2xvcjMuZnJvbVJHQigyMzQsIDI1NSwgMCkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC40MCwgQ29sb3IzLmZyb21SR0IoMjEsIDI1NSwgMCkpLAogICAgICAgIENvbG9yU2VxdWVuY2VLZXlwb2ludC5uZXcoMC42MCwgQ29sb3IzLmZyb21SR0IoMCwgMjU1LCAyNTUpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuODAsIENvbG9yMy5mcm9tUkdCKDAsIDE3LCAyNTUpKSwKICAgICAgICBDb2xvclNlcXVlbmNlS2V5cG9pbnQubmV3KDAuOTAsIENvbG9yMy5mcm9tUkdCKDI1NSwgMCwgMjUxKSksCiAgICAgICAgQ29sb3JTZXF1ZW5jZUtleXBvaW50Lm5ldygxLjAwLCBDb2xvcjMuZnJvbVJHQigyNTUsIDAsIDQpKQogICAgICB9KQogICAgfSlsb2NhbCBTYXZlUG9zMiA9IENyZWF0ZSgiRnJhbWUiLCBncmFkZSwge1Zpc2libGUgPSBmYWxzZSwgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAwKX0pCiAgICAKICAgIGxvY2FsIEFfMSA9IENyZWF0ZSgiRnJhbWUiLCBUZXh0QnV0dG9uLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDMwKSwKICAgICAgVmlzaWJsZSA9IGZhbHNlCiAgICB9KVN0cm9rZShBXzEpCiAgICAKICAgIGxvY2FsIFNlbGVjdDEgPSBDcmVhdGUoIkZyYW1lIiwgZ3JhZGUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAxMCksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIHNlbGVjdCgzLCBDb2xvcjMudG9IU1YoRGVmYXVsdCkpKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEFjdGl2ZSA9IHRydWUsCiAgICAgIERyYWdnYWJsZSA9IHRydWUKICAgIH0pQ29ybmVyKFNlbGVjdDEsIHtDb3JuZXJSYWRpdXMgPSBVRGltLm5ldygyLCAwKX0pU3Ryb2tlKFNlbGVjdDEsIHtDb2xvciA9IENvbG9yMy5mcm9tUkdCKDI1NSwgMjU1LCAyNTUpfSkKICAgIAogICAgbG9jYWwgU2VsZWN0MiA9IENyZWF0ZSgiRnJhbWUiLCBVSV9HcmFkZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDAsIDE1LCAwLCAxNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIHNlbGVjdCgyLCBDb2xvcjMudG9IU1YoRGVmYXVsdCkpLCAwLCBzZWxlY3QoMSwgQ29sb3IzLnRvSFNWKERlZmF1bHQpKSksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBBY3RpdmUgPSB0cnVlLAogICAgICBEcmFnZ2FibGUgPSB0cnVlCiAgICB9KUNvcm5lcihTZWxlY3QyLCB7Q29ybmVyUmFkaXVzID0gVURpbS5uZXcoMiwgMCl9KVN0cm9rZShTZWxlY3QyLCB7Q29sb3IgPSBDb2xvcjMuZnJvbVJHQigyNTUsIDI1NSwgMjU1KX0pCiAgCiAgICBVSV9HcmFkZS5Nb3VzZUJ1dHRvbjFDbGljazpDb25uZWN0KGZ1bmN0aW9uKCkKICAgICAgbG9jYWwgbW91c2UgPSBVc2VySW5wdXRTZXJ2aWNlOkdldE1vdXNlTG9jYXRpb24oKQogICAgICBsb2NhbCBzYXZlcG9zID0gU2F2ZVBvcy5BYnNvbHV0ZVBvc2l0aW9uCiAgICAgIENyZWF0ZVR3ZWVuKFNlbGVjdDIsICJQb3NpdGlvbiIsIFVEaW0yLm5ldygwLCBtb3VzZS5YIC0gc2F2ZXBvcy5YLCAwLCB0b251bWJlcihtb3VzZS5ZIC0gc2F2ZXBvcy5ZKSAtIDM1KSwgMC4zLCBmYWxzZSkKICAgIGVuZCkKICAgIAogICAgZ3JhZGUuTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIGxvY2FsIG1vdXNlID0gVXNlcklucHV0U2VydmljZTpHZXRNb3VzZUxvY2F0aW9uKCkuWSAtIDM1CiAgICAgIGxvY2FsIHNhdmVwb3MgPSBTYXZlUG9zMi5BYnNvbHV0ZVBvc2l0aW9uLlkKICAgICAgQ3JlYXRlVHdlZW4oU2VsZWN0MSwgIlBvc2l0aW9uIiwgVURpbTIubmV3KDAsIDAsIDAsIG1vdXNlIC0gc2F2ZXBvcyksIDAuMywgZmFsc2UpCiAgICBlbmQpCiAgICAKICAgIGxvY2FsIGZ1bmN0aW9uIGNhbGxiYWNrKClDYWxsYmFjayhDb2xvcjMuZnJvbUhTVihDb2xvckgsIENvbG9yUywgQ29sb3JWKSllbmQKICAgIGxvY2FsIGZ1bmN0aW9uIHVwZGNvbG9ycGlja2VyKCkKICAgICAgQ29sb3JIID0gdG9udW1iZXIoU2VsZWN0MS5Qb3NpdGlvbi5ZLk9mZnNldCkgLyA4MAogICAgICBDb2xvclMgPSB0b251bWJlcigyMTUgLSBTZWxlY3QyLlBvc2l0aW9uLlguT2Zmc2V0KSAvIDIxNQogICAgICBDb2xvclYgPSB0b251bWJlcig3NSAtIFNlbGVjdDIuUG9zaXRpb24uWS5PZmZzZXQpIC8gNzUKICAgICAgVUlfR3JhZGUuSW1hZ2VDb2xvcjMgPSBDb2xvcjMuZnJvbUhTVihDb2xvckgsIDEsIDEpCiAgICAgIHBpY2tlci5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21IU1YoQ29sb3JILCBDb2xvclMsIENvbG9yVikKICAgICAgY2FsbGJhY2soKQogICAgZW5kCiAgICAKICAgIHVwZGNvbG9ycGlja2VyKCkKICAgIAogICAgU2VsZWN0MS5DaGFuZ2VkOkNvbm5lY3QoZnVuY3Rpb24ocHJvcCkKICAgICAgaWYgcHJvcCA9PSAiUG9zaXRpb24iIHRoZW4KICAgICAgICBTZWxlY3QxLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIG1hdGguY2xhbXAoU2VsZWN0MS5Qb3NpdGlvbi5ZLk9mZnNldCwgMCwgODApKQogICAgICAgIHVwZGNvbG9ycGlja2VyKCkKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIFNlbGVjdDIuQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKHByb3ApCiAgICAgIGlmIHByb3AgPT0gIlBvc2l0aW9uIiB0aGVuCiAgICAgICAgU2VsZWN0Mi5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCBtYXRoLmNsYW1wKFNlbGVjdDIuUG9zaXRpb24uWC5PZmZzZXQsIDAsIDIyMiksIDAsIG1hdGguY2xhbXAoU2VsZWN0Mi5Qb3NpdGlvbi5ZLk9mZnNldCwgMCwgNzUpKQogICAgICAgIHVwZGNvbG9ycGlja2VyKCkKICAgICAgZW5kCiAgICBlbmQpCiAgICAKICAgIFRleHRCdXR0b24uQ2hhbmdlZDpDb25uZWN0KGZ1bmN0aW9uKHByb3ApCiAgICAgIGlmIHByb3AgPT0gIlNpemUiIHRoZW4KICAgICAgICBpZiBUZXh0QnV0dG9uLlNpemUuWS5PZmZzZXQgPj0gNjAgdGhlbgogICAgICAgICAgcGlja2VyLlBvc2l0aW9uID0gVURpbTIubmV3KDAsIDUsIDAsIDUpCiAgICAgICAgICBVSV9HcmFkZS5WaXNpYmxlID0gdHJ1ZQogICAgICAgICAgQV8xLlZpc2libGUgPSB0cnVlCiAgICAgICAgICBncmFkZS5WaXNpYmxlID0gdHJ1ZQogICAgICAgIGVsc2UKICAgICAgICAgIHBpY2tlci5Qb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA1LCAwLCAyLjUpCiAgICAgICAgICBVSV9HcmFkZS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgIEFfMS5WaXNpYmxlID0gZmFsc2UKICAgICAgICAgIGdyYWRlLlZpc2libGUgPSBmYWxzZQogICAgICAgIGVuZAogICAgICBlbmQKICAgIGVuZCkKICAgIAogICAgbG9jYWwgb25vZmYgPSBmYWxzZQogICAgY2xpY2suTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgIG9ub2ZmID0gbm90IG9ub2ZmCiAgICAgIGlmIG9ub2ZmID09IHRydWUgdGhlbgogICAgICAgIGxvY2FsIHR3ZWVuID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShUZXh0QnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIpLAogICAgICAgIHtTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDE0MCl9KXR3ZWVuOnBsYXkoKXR3ZWVuLkNvbXBsZXRlZDpXYWl0KCkKICAgICAgZWxzZQogICAgICAgIGxvY2FsIHR3ZWVuID0gVHdlZW5TZXJ2aWNlOkNyZWF0ZShUZXh0QnV0dG9uLCBUd2VlbkluZm8ubmV3KDAuMiwgRW51bS5FYXNpbmdTdHlsZS5MaW5lYXIpLAogICAgICAgIHtTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KX0pdHdlZW46cGxheSgpdHdlZW4uQ29tcGxldGVkOldhaXQoKQogICAgICBlbmQKICAgIGVuZCkKICBlbmQKICAKICBmdW5jdGlvbiBBZGREcm9wZG93bihwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBEcm9wZG93bk5hbWUgPSBDb25maWdzLk5hbWUgb3IgIkRyb3Bkb3duISEiCiAgICBsb2NhbCBEZWZhdWx0ID0gQ29uZmlncy5EZWZhdWx0IG9yICJUZXh0Qm94IgogICAgbG9jYWwgT3B0aW9ucyA9IENvbmZpZ3MuT3B0aW9ucyBvciB7IjEiLCAiMiIsICIzIn0KICAgIGxvY2FsIERlZmF1bHQgPSBDb25maWdzLkRlZmF1bHQgb3IgIjIiCiAgICBsb2NhbCBDYWxsYmFjayA9IENvbmZpZ3MuQ2FsbGJhY2sgb3IgZnVuY3Rpb24oKSBlbmQKICAgIAogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIHBhcmVudCwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9PcHRpb25zLAogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgVGV4dCA9ICIiLAogICAgICBBdXRvQnV0dG9uQ29sb3IgPSBmYWxzZQogICAgfSlDb3JuZXIoRnJhbWUpU3Ryb2tlKEZyYW1lKQogICAgCiAgICBsb2NhbCBUZXh0TGFiZWwgPSBDcmVhdGUoIlRleHRMYWJlbCIsIFRleHRCdXR0b24sIHsKICAgICAgVGV4dFNpemUgPSAxMiwKICAgICAgVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0LAogICAgICBUZXh0ID0gRHJvcGRvd25OYW1lLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgUG9zaXRpb24gPSBVRGltMi5uZXcoMCwgMzUsIDAsIDApLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQKICAgIH0pVGV4dFNldENvbG9yKFRleHRMYWJlbCkKICAgIAogICAgbG9jYWwgTGluZSA9IENyZWF0ZSgiRnJhbWUiLCBUZXh0QnV0dG9uLCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDAsIDAsIDI1KSwKICAgICAgQm9yZGVyU2l6ZVBpeGVsID0gMCwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9TdHJva2UsCiAgICAgIFZpc2libGUgPSBmYWxzZQogICAgfSkKICAgIAogICAgbG9jYWwgQXJyb3cgPSBDcmVhdGUoIkltYWdlTGFiZWwiLCBUZXh0QnV0dG9uLCB7CiAgICAgIEltYWdlID0gInJieGFzc2V0aWQ6Ly82MDMxMDkwOTkwIiwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCAyNSwgMCwgMjUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA1LCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEKICAgIH0pCiAgICAKICAgIGxvY2FsIERlZmF1bHRUZXh0ID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBUZXh0QnV0dG9uLCB7CiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfSHViLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC4xLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygxLCAtMjAsIDAsIDIuNSksCiAgICAgIEFuY2hvclBvaW50ID0gVmVjdG9yMi5uZXcoMSwgMCksCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgMTAwLCAwLCAyMCksCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfRGFya1RleHQsCiAgICAgIFRleHRTY2FsZWQgPSB0cnVlLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgICBUZXh0ID0gIi4uLiIKICAgIH0pQ29ybmVyKERlZmF1bHRUZXh0KVN0cm9rZShEZWZhdWx0VGV4dCkKICAgIAogICAgbG9jYWwgU2Nyb2xsQmFyID0gQ3JlYXRlKCJTY3JvbGxpbmdGcmFtZSIsIFRleHRCdXR0b24sIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAxLCAtMjUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAwLCAwLCAyNSksCiAgICAgIENhbnZhc1NpemUgPSBVRGltMi5uZXcoKSwKICAgICAgU2Nyb2xsaW5nRGlyZWN0aW9uID0gIlkiLAogICAgICBBdXRvbWF0aWNDYW52YXNTaXplID0gIlkiLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgU2Nyb2xsQmFyVGhpY2tuZXNzID0gMgogICAgfSlDcmVhdGUoIlVJUGFkZGluZyIsIFNjcm9sbEJhciwgewogICAgICBQYWRkaW5nTGVmdCA9IFVEaW0ubmV3KDAsIDEwKSwKICAgICAgUGFkZGluZ1JpZ2h0ID0gVURpbS5uZXcoMCwgMTApLAogICAgICBQYWRkaW5nVG9wID0gVURpbS5uZXcoMCwgMTApLAogICAgICBQYWRkaW5nQm90dG9tID0gVURpbS5uZXcoMCwgMTApCiAgICB9KUNyZWF0ZSgiVUlMaXN0TGF5b3V0IiwgU2Nyb2xsQmFyLCB7CiAgICAgIFBhZGRpbmcgPSBVRGltLm5ldygwLCA1KQogICAgfSkKICAgIAogICAgbG9jYWwgZnVuY3Rpb24gQWRkT3B0aW9uKE9wdGlvbk5hbWUpCiAgICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBTY3JvbGxCYXIsIHsKICAgICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDE1KSwKICAgICAgICBUZXh0ID0gT3B0aW9uTmFtZSwKICAgICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgICAgIFRleHRTaXplID0gMTIsCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE4MCwgMTgwLCAxODApLAogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgIH0pQ29ybmVyKFRleHRCdXR0b24pCiAgICAgIAogICAgICBsb2NhbCBTZWxlY3RUYWJsZSA9IHt9CiAgICAgIGxvY2FsIE9uT2ZmID0gZmFsc2UKICAgICAgaWYgT3B0aW9uTmFtZSA9PSBEZWZhdWx0IHRoZW4KICAgICAgICBPbk9mZiA9IHRydWUKICAgICAgICBUZXh0QnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjgKICAgICAgICBUZXh0QnV0dG9uLlRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dAogICAgICAgIERlZmF1bHRUZXh0LlRleHQgPSBPcHRpb25OYW1lCiAgICAgICAgQ2FsbGJhY2soT3B0aW9uTmFtZSkKICAgICAgZW5kCiAgICAgIAogICAgICBUZXh0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICAgIGZvciBfLHYgaW4gcGFpcnMoU2Nyb2xsQmFyOkdldENoaWxkcmVuKCkpIGRvCiAgICAgICAgICBpZiB2OklzQSgiVGV4dEJ1dHRvbiIpIHRoZW4KICAgICAgICAgICAgdi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMQogICAgICAgICAgICB2LlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxODAsIDE4MCwgMTgwKQogICAgICAgICAgZW5kCiAgICAgICAgZW5kCiAgICAgICAgRGVmYXVsdFRleHQuVGV4dCA9IE9wdGlvbk5hbWUKICAgICAgICBDYWxsYmFjayhPcHRpb25OYW1lKQogICAgICAgIFRleHRCdXR0b24uQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDAuOAogICAgICAgIFRleHRCdXR0b24uVGV4dENvbG9yMyA9IENvbmZpZ3NfSFVCLkNvcl9UZXh0CiAgICAgIGVuZCkKICAgIGVuZAogICAgCiAgICBmb3IgXyx2IGluIHBhaXJzKE9wdGlvbnMpIGRvCiAgICAgIEFkZE9wdGlvbih2KQogICAgZW5kCiAgICAKICAgIGxvY2FsIERyb3BPbk9mZiA9IGZhbHNlCiAgICBUZXh0QnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBsb2NhbCBPcHRpb25TaXplLCBPcHRpb25zTnVtYmVyID0gMjUsIDAKICAgICAgZm9yIF8sdiBpbiBwYWlycyhTY3JvbGxCYXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICBpZiB2OklzQSgiVGV4dEJ1dHRvbiIpIGFuZCBPcHRpb25zTnVtYmVyIDwgNSB0aGVuCiAgICAgICAgICBPcHRpb25zTnVtYmVyID0gT3B0aW9uc051bWJlciArIDEKICAgICAgICAgIE9wdGlvblNpemUgPSBPcHRpb25TaXplICsgdG9udW1iZXIodi5TaXplLlkuT2Zmc2V0ICsgMTApCiAgICAgICAgZW5kCiAgICAgIGVuZAogICAgICBpZiBub3QgRHJvcE9uT2ZmIHRoZW4KICAgICAgICBDcmVhdGVUd2VlbihUZXh0QnV0dG9uLCAiU2l6ZSIsIFVEaW0yLm5ldygxLCAwLCAwLCBPcHRpb25TaXplKSwgMC4zLCBmYWxzZSkKICAgICAgICBDcmVhdGVUd2VlbihBcnJvdywgIlJvdGF0aW9uIiwgMTgwLCAwLjMsIGZhbHNlKQogICAgICAgIERyb3BPbk9mZiA9IHRydWUKICAgICAgICBMaW5lLlZpc2libGUgPSB0cnVlCiAgICAgIGVsc2UKICAgICAgICBDcmVhdGVUd2VlbihUZXh0QnV0dG9uLCAiU2l6ZSIsIFVEaW0yLm5ldygxLCAwLCAwLCAyNSksIDAuMywgZmFsc2UpCiAgICAgICAgQ3JlYXRlVHdlZW4oQXJyb3csICJSb3RhdGlvbiIsIDAsIDAuMywgdHJ1ZSkKICAgICAgICBEcm9wT25PZmYgPSBmYWxzZQogICAgICAgIExpbmUuVmlzaWJsZSA9IGZhbHNlCiAgICAgIGVuZAogICAgZW5kKQogICAgcmV0dXJuIHtTY3JvbGxCYXIsIERlZmF1bHQsIENhbGxiYWNrLCBEZWZhdWx0VGV4dH0KICBlbmQKICAKICBmdW5jdGlvbiBVcGRhdGVEcm9wZG93bihEcm9wZG93biwgTmV3T3B0aW9ucykKICAgIGxvY2FsIFNjcm9sbEJhciA9IERyb3Bkb3duWzFdCiAgICBsb2NhbCBEZWZhdWx0ID0gRHJvcGRvd25bMl0KICAgIGxvY2FsIENhbGxiYWNrID0gRHJvcGRvd25bM10KICAgIGxvY2FsIERlZmF1bHRUZXh0ID0gRHJvcGRvd25bNF0KICAgIAogICAgZm9yIF8sdiBpbiBwYWlycyhTY3JvbGxCYXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgaWYgdjpJc0EoIlRleHRCdXR0b24iKSB0aGVuCiAgICAgICAgdjpEZXN0cm95KCkKICAgICAgZW5kCiAgICBlbmQKICAgIAogICAgbG9jYWwgZnVuY3Rpb24gQWRkT3B0aW9uKE9wdGlvbk5hbWUpCiAgICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBTY3JvbGxCYXIsIHsKICAgICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDE1KSwKICAgICAgICBUZXh0ID0gT3B0aW9uTmFtZSwKICAgICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250LAogICAgICAgIFRleHRTaXplID0gMTIsCiAgICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE4MCwgMTgwLCAxODApLAogICAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgIH0pQ29ybmVyKFRleHRCdXR0b24pCiAgICAgIAogICAgICBsb2NhbCBTZWxlY3RUYWJsZSA9IHt9CiAgICAgIGxvY2FsIE9uT2ZmID0gZmFsc2UKICAgICAgaWYgT3B0aW9uTmFtZSA9PSBEZWZhdWx0IHRoZW4KICAgICAgICBPbk9mZiA9IHRydWUKICAgICAgICBUZXh0QnV0dG9uLkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAwLjgKICAgICAgICBUZXh0QnV0dG9uLlRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dAogICAgICAgIERlZmF1bHRUZXh0LlRleHQgPSBPcHRpb25OYW1lCiAgICAgICAgQ2FsbGJhY2soT3B0aW9uTmFtZSkKICAgICAgZWxzZQogICAgICAgIERlZmF1bHRUZXh0LlRleHQgPSAiLi4uIgogICAgICBlbmQKICAgICAgCiAgICAgIFRleHRCdXR0b24uTW91c2VCdXR0b24xQ2xpY2s6Q29ubmVjdChmdW5jdGlvbigpCiAgICAgICAgZm9yIF8sdiBpbiBwYWlycyhTY3JvbGxCYXI6R2V0Q2hpbGRyZW4oKSkgZG8KICAgICAgICAgIGlmIHY6SXNBKCJUZXh0QnV0dG9uIikgdGhlbgogICAgICAgICAgICB2LkJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxCiAgICAgICAgICAgIHYuVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDE4MCwgMTgwLCAxODApCiAgICAgICAgICBlbmQKICAgICAgICBlbmQKICAgICAgICBEZWZhdWx0VGV4dC5UZXh0ID0gT3B0aW9uTmFtZQogICAgICAgIENhbGxiYWNrKE9wdGlvbk5hbWUpCiAgICAgICAgVGV4dEJ1dHRvbi5CYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMC44CiAgICAgICAgVGV4dEJ1dHRvbi5UZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQKICAgICAgZW5kKQogICAgZW5kCiAgICAKICAgIGZvciBfLHYgaW4gcGFpcnMoTmV3T3B0aW9ucykgZG8KICAgICAgQWRkT3B0aW9uKHYpCiAgICBlbmQKICBlbmQKICAKICBmdW5jdGlvbiBBZGRUZXh0TGFiZWwocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgTGFiZWxOYW1lID0gQ29uZmlnc1sxXSBvciBDb25maWdzLk5hbWUgb3IgIlRleHQgTGFiZWwhISIKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIE5hbWUgPSAiRnJhbWUiCiAgICB9KUNvcm5lcihGcmFtZSlTdHJva2UoRnJhbWUpCiAgICAKICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBGcmFtZSwgewogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX1RleHQsCiAgICAgIFRleHQgPSBMYWJlbE5hbWUsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAyMCwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSkKICAgIFRleHRTZXRDb2xvcihUZXh0QnV0dG9uKQogICAgcmV0dXJuIFRleHRCdXR0b24KICBlbmQKICAKICBmdW5jdGlvbiBTZXRMYWJlbChsYWJlbCwgTmV3VmFsdWUpCiAgICBsYWJlbC5UZXh0ID0gTmV3VmFsdWUKICBlbmQKICAKICBmdW5jdGlvbiBBZGRJbWFnZUxhYmVsKHBhcmVudCwgQ29uZmlncykKICAgIGxvY2FsIExhYmVsTmFtZSA9IENvbmZpZ3NbMV0gb3IgQ29uZmlncy5OYW1lIG9yICIiCiAgICBsb2NhbCBMYWJlbEltYWdlID0gQ29uZmlnc1syXSBvciBDb25maWdzLkltYWdlIG9yICJJbWFnZSBMYWJlbCIKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMCwgOTUsIDAsIDExMCksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfT3B0aW9ucywKICAgICAgTmFtZSA9ICJGcmFtZSIKICAgIH0pQ29ybmVyKEZyYW1lKVN0cm9rZShGcmFtZSkKICAgIAogICAgbG9jYWwgVGV4dEJ1dHRvbiA9IENyZWF0ZSgiVGV4dEJ1dHRvbiIsIEZyYW1lLCB7CiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IExhYmVsTmFtZSwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBGb250ID0gQ29uZmlnc19IVUIuVGV4dF9Gb250CiAgICB9KQogICAgCiAgICBsb2NhbCBJbWFnZUxhYmVsID0gQ3JlYXRlKCJJbWFnZUxhYmVsIiwgRnJhbWUsIHsKICAgICAgSW1hZ2UgPSBMYWJlbEltYWdlLAogICAgICBTaXplID0gVURpbTIubmV3KDAsIDc1LCAwLCA3NSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEwLCAwLCAyNSkKICAgIH0pCiAgICBUZXh0U2V0Q29sb3IoVGV4dEJ1dHRvbikKICAgIHJldHVybiBJbWFnZUxhYmVsCiAgZW5kCiAgCiAgZnVuY3Rpb24gU2V0SW1hZ2UobGFiZWwsIE5ld0ltYWdlKQogICAgbGFiZWwuSW1hZ2UgPSBOZXdJbWFnZQogIGVuZAogIAogIGZ1bmN0aW9uIEFkZFBhcmFncmFwaChwYXJlbnQsIENvbmZpZ3MpCiAgICBsb2NhbCBQYXJhZ3JhcGhOYW1lMSA9IENvbmZpZ3NbMV0gb3IgQ29uZmlncy5UaXRsZSBvciAiUGFyYWdyYXBoISEiCiAgICBsb2NhbCBQYXJhZ3JhcGhOYW1lMiA9IENvbmZpZ3NbMV0gb3IgQ29uZmlncy5UZXh0IG9yICJQYXJhZ3JhcGghISIKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBCYWNrZ3JvdW5kQ29sb3IzID0gQ29uZmlnc19IVUIuQ29yX09wdGlvbnMsCiAgICAgIE5hbWUgPSAiRnJhbWUiLAogICAgICBBdXRvbWF0aWNTaXplID0gIlkiCiAgICB9KUNvcm5lcihGcmFtZSlTdHJva2UoRnJhbWUpQ3JlYXRlKCJVSUxpc3RMYXlvdXQiLCBGcmFtZSlDcmVhdGUoIlVJUGFkZGluZyIsIEZyYW1lLCB7CiAgICAgIFBhZGRpbmdMZWZ0ID0gVURpbS5uZXcoMCwgMjApLCBQYWRkaW5nUmlnaHQgPSBVRGltLm5ldygwLCAxMCksIFBhZGRpbmdUb3AgPSBVRGltLm5ldygwLCA1KSwgUGFkZGluZ0JvdHRvbSA9IFVEaW0ubmV3KDAsIDUpCiAgICB9KQogICAgCiAgICBsb2NhbCBUZXh0QnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUsIHsKICAgICAgTmFtZSA9ICJGcmFtZSIsCiAgICAgIFRleHRTaXplID0gMTIsCiAgICAgIFRleHRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfVGV4dCwKICAgICAgVGV4dCA9IFBhcmFncmFwaE5hbWUxLAogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDApLAogICAgICBBdXRvbWF0aWNTaXplID0gIlkiLAogICAgICBCYWNrZ3JvdW5kVHJhbnNwYXJlbmN5ID0gMSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIFRleHRZQWxpZ25tZW50ID0gIlRvcCIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRXcmFwcGVkID0gdHJ1ZQogICAgfSlUZXh0U2V0Q29sb3IoVGV4dEJ1dHRvbikKICAgIAogICAgbG9jYWwgVGV4dExhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZSwgewogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAwKSwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIEF1dG9tYXRpY1NpemUgPSAiWSIsCiAgICAgIFRleHRYQWxpZ25tZW50ID0gIkxlZnQiLAogICAgICBUZXh0WUFsaWdubWVudCA9ICJUb3AiLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0RhcmtUZXh0LAogICAgICBUZXh0U2l6ZSA9IDExLAogICAgICBUZXh0ID0gUGFyYWdyYXBoTmFtZTIsCiAgICAgIEZvbnQgPSBDb25maWdzX0hVQi5UZXh0X0ZvbnQsCiAgICAgIFRleHRXcmFwcGVkID0gdHJ1ZQogICAgfSkKICAgIHJldHVybiB7VGV4dEJ1dHRvbiwgVGV4dExhYmVsfQogIGVuZAogIAogIGZ1bmN0aW9uIFNldFBhcmFncmFwaChQYXJhZ3JhcGgsIE5ld1ZhbHVlKQogICAgUGFyYWdyYXBoWzFdLlRleHQgPSBOZXdWYWx1ZVsxXQogICAgUGFyYWdyYXBoWzJdLlRleHQgPSBOZXdWYWx1ZVsyXQogIGVuZAogIAogIGZ1bmN0aW9uIEFkZFNlY3Rpb24ocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgU2VjdGlvbk5hbWUgPSBDb25maWdzWzFdIG9yIENvbmZpZ3MuTmFtZSBvciAiU2VjdGlvbiEhIgogICAgCiAgICBsb2NhbCBGcmFtZSA9IENyZWF0ZSgiRnJhbWUiLCBwYXJlbnQsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAwLCAwLCAyNSksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb25maWdzX0hVQi5Db3JfSHViLAogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgVHJhbnNwYXJlbmN5ID0gMQogICAgfSlDb3JuZXIoRnJhbWUpCiAgICAKICAgIGxvY2FsIFRleHRCdXR0b24gPSBDcmVhdGUoIlRleHRCdXR0b24iLCBGcmFtZSwgewogICAgICBUZXh0U2l6ZSA9IDEyLAogICAgICBUZXh0Q29sb3IzID0gQ29uZmlnc19IVUIuQ29yX0RhcmtUZXh0LAogICAgICBUZXh0ID0gU2VjdGlvbk5hbWUsCiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMjUpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCAxMCwgMCwgMCksCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgRm9udCA9IENvbmZpZ3NfSFVCLlRleHRfRm9udAogICAgfSkKICAgIHJldHVybiBUZXh0QnV0dG9uCiAgZW5kCiAgCiAgZnVuY3Rpb24gU2V0U2VjdGlvbihTZWN0aW9uLCBOZXdOYW1lKQogICAgU2VjdGlvbi5UZXh0ID0gTmV3TmFtZQogIGVuZAogIAogIGZ1bmN0aW9uIEFkZERpc2NvcmQocGFyZW50LCBDb25maWdzKQogICAgbG9jYWwgRGlzY29yZExpbmsgPSBDb25maWdzWzFdIG9yIENvbmZpZ3MuRGlzY29yZExpbmsgb3IgImh0dHBzOi8vZGlzY29yZC5nZy8iCiAgICBsb2NhbCBEaXNjb3JkSWNvbiA9IENvbmZpZ3NbMl0gb3IgQ29uZmlncy5EaXNjb3JkSWNvbiBvciAicmJ4YXNzZXRpZDovLyIKICAgIGxvY2FsIERpc2NvcmRUaXRsZSA9IENvbmZpZ3NbM10gb3IgQ29uZmlncy5EaXNjb3JkVGl0bGUgb3IgIiIKICAgIAogICAgbG9jYWwgRnJhbWUgPSBDcmVhdGUoIkZyYW1lIiwgcGFyZW50LCB7CiAgICAgIFNpemUgPSBVRGltMi5uZXcoMSwgMCwgMCwgMTEwKSwKICAgICAgQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDMwLCAzMCwgMzApLAogICAgICBOYW1lID0gIkZyYW1lIiwKICAgICAgQXV0b21hdGljU2l6ZSA9ICJZIgogICAgfSkKICAgIAogICAgbG9jYWwgTGlua0xhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgVGV4dCA9IERpc2NvcmRMaW5rLAogICAgICBUZXh0WEFsaWdubWVudCA9ICJMZWZ0IiwKICAgICAgQmFja2dyb3VuZFRyYW5zcGFyZW5jeSA9IDEsCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEyLCAwLCAwKSwKICAgICAgVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDAsIDEyMCwgMjU1KSwKICAgICAgRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkLAogICAgICBUZXh0U2l6ZSA9IDE0CiAgICB9KQogICAgCiAgICBsb2NhbCBUaXRsZUxhYmVsID0gQ3JlYXRlKCJUZXh0TGFiZWwiLCBGcmFtZSwgewogICAgICBTaXplID0gVURpbTIubmV3KDEsIDAsIDAsIDI1KSwKICAgICAgVGV4dCA9IERpc2NvcmRUaXRsZSwKICAgICAgVGV4dFhBbGlnbm1lbnQgPSAiTGVmdCIsCiAgICAgIEJhY2tncm91bmRUcmFuc3BhcmVuY3kgPSAxLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLCA2MCwgMCwgMjUpLAogICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjAwLCAyMDAsIDIwMCksCiAgICAgIEZvbnQgPSBFbnVtLkZvbnQuR290aGFtQm9sZCwKICAgICAgVGV4dFNpemUgPSAxNAogICAgfSkKICAgIAogICAgbG9jYWwgSWNvbkxhYmVsID0gQ3JlYXRlKCJJbWFnZUxhYmVsIiwgRnJhbWUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygwLCA0MCwgMCwgNDApLAogICAgICBBbmNob3JQb2ludCA9IFZlY3RvcjIubmV3KDAsIDAuNSksCiAgICAgIFBvc2l0aW9uID0gVURpbTIubmV3KDAsIDEyLCAwLjQ1LCAwKSwKICAgICAgSW1hZ2UgPSBEaXNjb3JkSWNvbgogICAgfSlDb3JuZXIoSWNvbkxhYmVsKQogICAgCiAgICBsb2NhbCBKb2luQnV0dG9uID0gQ3JlYXRlKCJUZXh0QnV0dG9uIiwgRnJhbWUsIHsKICAgICAgU2l6ZSA9IFVEaW0yLm5ldygxLCAtMjQsIDAsIDI1KSwKICAgICAgQW5jaG9yUG9pbnQgPSBWZWN0b3IyLm5ldygwLjUsIDEpLAogICAgICBQb3NpdGlvbiA9IFVEaW0yLm5ldygwLjUsIDAsIDEsIC04KSwKICAgICAgVGV4dCA9ICJKb2luIiwKICAgICAgRm9udCA9IEVudW0uRm9udC5Hb3RoYW1Cb2xkLAogICAgICBUZXh0U2l6ZSA9IDE1LAogICAgICBUZXh0Q29sb3IzID0gQ29sb3IzLmZyb21SR0IoMjIwLCAyMjAsIDIyMCksCiAgICAgIEJhY2tncm91bmRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQig1MCwgMjAwLCA1MCkKICAgIH0pQ29ybmVyKEljb25MYWJlbCkKICAgIAogICAgbG9jYWwgdGltZSA9IHRpY2soKQogICAgQ2xpY2tDb250ZXIgPSAwCiAgICBKb2luQnV0dG9uLk1vdXNlQnV0dG9uMUNsaWNrOkNvbm5lY3QoZnVuY3Rpb24oKQogICAgICBpZiBDbGlja0NvbnRlciA9PSAwIG9yIHRpY2soKSAtIHRpbWUgPiA1IHRoZW4gdGltZSA9IHRpY2soKSBzZXRjbGlwYm9hcmQoRGlzY29yZExpbmspIENsaWNrQ29udGVyID0gQ2xpY2tDb250ZXIgKyAxCiAgICAgICAgSm9pbkJ1dHRvbi5UZXh0ID0gIkNvcGllZCB0byBDbGlwYm9hcmQiCiAgICAgICAgSm9pbkJ1dHRvbi5CYWNrZ3JvdW5kQ29sb3IzID0gQ29sb3IzLmZyb21SR0IoMTAwLCAxMDAsIDEwMCkKICAgICAgICBKb2luQnV0dG9uLlRleHRDb2xvcjMgPSBDb2xvcjMuZnJvbVJHQigxNTAsIDE1MCwgMTUwKQogICAgICAgIHRhc2sud2FpdCg1KQogICAgICAgIEpvaW5CdXR0b24uVGV4dCA9ICJKb2luIgogICAgICAgIEpvaW5CdXR0b24uQmFja2dyb3VuZENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDUwLCAyMDAsIDUwKQogICAgICAgIEpvaW5CdXR0b24uVGV4dENvbG9yMyA9IENvbG9yMy5mcm9tUkdCKDIyMCwgMjIwLCAyMjApCiAgICAgIGVuZAogICAgZW5kKQogIGVuZAogIHJldHVybiBNZW51CmVuZA=="></a>